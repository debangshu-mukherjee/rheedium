<!doctype html>
<html class="no-js" lang="en" data-content_root="./">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="viewport" content="width=device-width, initial-scale=1" />
<link rel="index" title="Index" href="genindex.html" /><link rel="search" title="Search" href="search.html" /><link rel="prev" title="Tutorials" href="tutorials/index.html" />

    <!-- Generated with Sphinx 8.1.3 and Furo 2025.07.19 -->
        <title>API Reference - rheedium 2025.06.23 documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=d111a655" />
    <link rel="stylesheet" type="text/css" href="_static/styles/furo.css?v=25af2a20" />
    <link rel="stylesheet" type="text/css" href="_static/styles/furo-extensions.css?v=8dab3a3b" />
    <link rel="stylesheet" type="text/css" href="_static/custom.css?v=3fa2ad6f" />
    
    


<style>
  body {
    --color-code-background: #f2f2f2;
  --color-code-foreground: #1e1e1e;
  --color-brand-primary: #0066cc;
  --color-brand-content: #0066cc;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #2b2b2b;
  --color-code-foreground: #f8f8f2;
  --color-brand-primary: #3399ff;
  --color-brand-content: #3399ff;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #2b2b2b;
  --color-code-foreground: #f8f8f2;
  --color-brand-primary: #3399ff;
  --color-brand-content: #3399ff;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-with-moon" viewBox="0 0 24 24">
    <title>Auto light/dark, in light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path style="opacity: 50%" d="M 5.411 14.504 C 5.471 14.504 5.532 14.504 5.591 14.504 C 3.639 16.319 4.383 19.569 6.931 20.352 C 7.693 20.586 8.512 20.551 9.25 20.252 C 8.023 23.207 4.056 23.725 2.11 21.184 C 0.166 18.642 1.702 14.949 4.874 14.536 C 5.051 14.512 5.231 14.5 5.411 14.5 L 5.411 14.504 Z"/>
      <line x1="14.5" y1="3.25" x2="14.5" y2="1.25"/>
      <line x1="14.5" y1="15.85" x2="14.5" y2="17.85"/>
      <line x1="10.044" y1="5.094" x2="8.63" y2="3.68"/>
      <line x1="19" y1="14.05" x2="20.414" y2="15.464"/>
      <line x1="8.2" y1="9.55" x2="6.2" y2="9.55"/>
      <line x1="20.8" y1="9.55" x2="22.8" y2="9.55"/>
      <line x1="10.044" y1="14.006" x2="8.63" y2="15.42"/>
      <line x1="19" y1="5.05" x2="20.414" y2="3.636"/>
      <circle cx="14.5" cy="9.55" r="3.6"/>
    </svg>
  </symbol>
  <symbol id="svg-moon-with-sun" viewBox="0 0 24 24">
    <title>Auto light/dark, in dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path d="M 8.282 7.007 C 8.385 7.007 8.494 7.007 8.595 7.007 C 5.18 10.184 6.481 15.869 10.942 17.24 C 12.275 17.648 13.706 17.589 15 17.066 C 12.851 22.236 5.91 23.143 2.505 18.696 C -0.897 14.249 1.791 7.786 7.342 7.063 C 7.652 7.021 7.965 7 8.282 7 L 8.282 7.007 Z"/>
      <line style="opacity: 50%" x1="18" y1="3.705" x2="18" y2="2.5"/>
      <line style="opacity: 50%" x1="18" y1="11.295" x2="18" y2="12.5"/>
      <line style="opacity: 50%" x1="15.316" y1="4.816" x2="14.464" y2="3.964"/>
      <line style="opacity: 50%" x1="20.711" y1="10.212" x2="21.563" y2="11.063"/>
      <line style="opacity: 50%" x1="14.205" y1="7.5" x2="13.001" y2="7.5"/>
      <line style="opacity: 50%" x1="21.795" y1="7.5" x2="23" y2="7.5"/>
      <line style="opacity: 50%" x1="15.316" y1="10.184" x2="14.464" y2="11.036"/>
      <line style="opacity: 50%" x1="20.711" y1="4.789" x2="21.563" y2="3.937"/>
      <circle style="opacity: 50%" cx="18" cy="7.5" r="2.169"/>
    </svg>
  </symbol>
  <symbol id="svg-pencil" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-pencil-code">
      <path d="M4 20h4l10.5 -10.5a2.828 2.828 0 1 0 -4 -4l-10.5 10.5v4" />
      <path d="M13.5 6.5l4 4" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
  <symbol id="svg-eye" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-eye-code">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M10 12a2 2 0 1 0 4 0a2 2 0 0 0 -4 0" />
      <path
        d="M11.11 17.958c-3.209 -.307 -5.91 -2.293 -8.11 -5.958c2.4 -4 5.4 -6 9 -6c3.6 0 6.6 2 9 6c-.21 .352 -.427 .688 -.647 1.008" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>

<a class="skip-to-content muted-link" href="#furo-main-content">Skip to content</a>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="index.html"><div class="brand">rheedium 2025.06.23 documentation</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
          <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="index.html">
  
  <span class="sidebar-brand-text">rheedium 2025.06.23 documentation</span>
  
</a><form class="sidebar-search-container" method="get" action="search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="jax_validation_pattern.html">JAX Validation Pattern for Factory Functions</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="tutorials/index.html">Tutorials</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><div class="visually-hidden">Toggle navigation of Tutorials</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="simple">
</ul>
</li>
<li class="toctree-l1 current current-page"><a class="current reference internal" href="#">API Reference</a></li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          <div class="view-this-page">
  <a class="muted-link" href="_sources/api.rst.txt" title="View this page">
    <svg><use href="#svg-eye"></use></svg>
    <span class="visually-hidden">View this page</span>
  </a>
</div>
<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
              <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main" id="furo-main-content">
          <section id="api-reference">
<h1>API Reference<a class="headerlink" href="#api-reference" title="Link to this heading">¶</a></h1>
<p>This page documents all public functions and classes in the rheedium package.</p>
<section id="input-output-module">
<h2>Input/Output Module<a class="headerlink" href="#input-output-module" title="Link to this heading">¶</a></h2>
<section id="module-inout">
<h3>Module: inout<a class="headerlink" href="#module-inout" title="Link to this heading">¶</a></h3>
<p>Data input/output utilities for RHEED simulation.</p>
</section>
<section id="functions">
<h3>Functions<a class="headerlink" href="#functions" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><dl class="simple">
<dt><cite>parse_cif</cite>:</dt><dd><p>Parse a CIF file into a JAX-compatible CrystalStructure</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><cite>symmetry_expansion</cite>:</dt><dd><p>Apply symmetry operations to expand fractional positions and remove duplicates</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><cite>atomic_symbol</cite>:</dt><dd><p>Returns atomic number for given atomic symbol string.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><cite>kirkland_potentials</cite>:</dt><dd><p>Loads Kirkland scattering factors from CSV file.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><cite>parse_xyz</cite>:</dt><dd><p>Parses an XYZ file and returns a list of atoms with their
element symbols and 3D coordinates.</p>
</dd>
</dl>
</li>
</ul>
</section>
<p><strong>Functions:</strong></p>
<dl class="py function">
<dt class="sig sig-object py" id="rheedium.inout.parse_cif">
<span class="sig-prename descclassname"><span class="pre">rheedium.inout.</span></span><span class="sig-name descname"><span class="pre">parse_cif</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cif_path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/pathlib.html#pathlib.Path" title="(in Python v3.13)"><span class="pre">Path</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#rheedium.types.CrystalStructure" title="rheedium.types.crystal_types.CrystalStructure"><span class="pre">CrystalStructure</span></a></span></span><a class="reference internal" href="_modules/rheedium/inout/cif.html#parse_cif"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#rheedium.inout.parse_cif" title="Link to this definition">¶</a></dt>
<dd><p>Parse a CIF file into a JAX-compatible CrystalStructure.</p>
<blockquote>
<div><dl class="simple">
<dt>cif_path<span class="classifier">str | Path</span></dt><dd><p>Path to the CIF file.</p>
</dd>
</dl>
<dl class="simple">
<dt>expanded_crystal<span class="classifier">CrystalStructure</span></dt><dd><p>Parsed crystal structure object with fractional and Cartesian
coordinates. Contains arrays of atomic positions in both fractional
(range [0,1]) and Cartesian (Ångstroms) coordinates, along with unit
cell parameters (lengths in Ångstroms, angles in degrees).</p>
</dd>
</dl>
<ul class="simple">
<li><p>Validate CIF file path and extension</p></li>
<li><p>Read CIF file content</p></li>
<li><p>Load atomic numbers mapping</p></li>
<li><p>Extract unit cell parameters (cell lengths and angles)</p></li>
<li><p>Parse atomic positions from atom site loop section</p></li>
<li><p>Convert element symbols to atomic numbers</p></li>
<li><p>Convert fractional to Cartesian coordinates using cell vectors</p></li>
<li><p>Parse symmetry operations from CIF file</p></li>
<li><p>Create initial CrystalStructure</p></li>
<li><p>Apply symmetry operations to expand positions</p></li>
<li><p>Return expanded crystal structure</p></li>
</ul>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">rheedium.inout.data_io</span><span class="w"> </span><span class="kn">import</span> <span class="n">parse_cif</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Parse a CIF file for silicon</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">structure</span> <span class="o">=</span> <span class="n">parse_cif</span><span class="p">(</span><span class="s2">&quot;path/to/silicon.cif&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Unit cell vectors:</span>
</pre></div>
</div>
</div></blockquote>
<dl>
<dt>{structure.vectors}”)</dt><dd><p>Unit cell vectors:
[[5.431 0.000 0.000]</p>
<blockquote>
<div><p>[0.000 5.431 0.000]
[0.000 0.000 5.431]]</p>
</div></blockquote>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Number of atoms: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">structure</span><span class="o">.</span><span class="n">positions</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="go">Number of atoms: 8</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="rheedium.inout.symmetry_expansion">
<span class="sig-prename descclassname"><span class="pre">rheedium.inout.</span></span><span class="sig-name descname"><span class="pre">symmetry_expansion</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">crystal</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#rheedium.types.CrystalStructure" title="rheedium.types.crystal_types.CrystalStructure"><span class="pre">CrystalStructure</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">sym_ops</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><span class="pre">list</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tolerance</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><span class="pre">float</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Float</span><span class="p"><span class="pre">[</span></span><span class="pre">Array</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">''</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1.0</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#rheedium.types.CrystalStructure" title="rheedium.types.crystal_types.CrystalStructure"><span class="pre">CrystalStructure</span></a></span></span><a class="reference internal" href="_modules/rheedium/inout/cif.html#symmetry_expansion"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#rheedium.inout.symmetry_expansion" title="Link to this definition">¶</a></dt>
<dd><p>Apply symmetry operations to expand fractional positions and remove duplicates.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>crystal</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">CrystalStructure</span></code>) – The initial crystal structure with symmetry-independent positions.</p></li>
<li><p><strong>sym_ops</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">List[str]</span></code>) – List of symmetry operations as strings from the CIF file.
Example: [“x,y,z”, “-x,-y,z”, …]</p></li>
<li><p><strong>tolerance</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a>, <em>optional</em>) – Distance tolerance in angstroms for duplicate atom removal.
Default: 1.0 Å.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Symmetry-expanded crystal structure without duplicates.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">CrystalStructure</span></code></p>
</dd>
</dl>
<p class="rubric">Algorithm</p>
<ul class="simple">
<li><p>Parse symmetry operations into functions by splitting operation strings
into components and creating evaluation functions for coefficients</p></li>
<li><p>Apply symmetry operations to each atomic position to generate new positions</p></li>
<li><p>Apply modulo 1 to keep positions within unit cell</p></li>
<li><p>Convert expanded positions to Cartesian coordinates using cell vectors</p></li>
<li><p>Remove duplicate positions by calculating distances and keeping only
unique positions within tolerance</p></li>
<li><p>Create and return expanded CrystalStructure</p></li>
</ul>
<div class="admonition-examples admonition">
<p class="admonition-title">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">rheedium.inout.data_io</span><span class="w"> </span><span class="kn">import</span> <span class="n">parse_cif</span><span class="p">,</span> <span class="n">symmetry_expansion</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Parse a CIF file and expand symmetry</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">structure</span> <span class="o">=</span> <span class="n">parse_cif</span><span class="p">(</span><span class="s2">&quot;path/to/structure.cif&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">expanded</span> <span class="o">=</span> <span class="n">symmetry_expansion</span><span class="p">(</span><span class="n">structure</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Original atoms: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">structure</span><span class="o">.</span><span class="n">positions</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Expanded atoms: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">expanded</span><span class="o">.</span><span class="n">positions</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="go">Original atoms: 1</span>
<span class="go">Expanded atoms: 8</span>
</pre></div>
</div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="rheedium.inout.atomic_symbol">
<span class="sig-prename descclassname"><span class="pre">rheedium.inout.</span></span><span class="sig-name descname"><span class="pre">atomic_symbol</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">symbol_string</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Integer</span><span class="p"><span class="pre">[</span></span><span class="pre">Array</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">''</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/rheedium/inout/xyz.html#atomic_symbol"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#rheedium.inout.atomic_symbol" title="Link to this definition">¶</a></dt>
<dd><p>Returns atomic number for given atomic symbol string.</p>
<p>Uses preloaded atomic number mapping for fast lookup.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>symbol_string</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>) – Chemical symbol for the element (e.g., “H”, “He”, “Li”)</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>atomic_number</strong> – Atomic number corresponding to the symbol</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a></p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#KeyError" title="(in Python v3.13)"><strong>KeyError</strong></a> – If atomic symbol is not found in the mapping</p></li>
<li><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#TypeError" title="(in Python v3.13)"><strong>TypeError</strong></a> – If input is not a string</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Algorithm</p>
<ul class="simple">
<li><p>Validate input is string</p></li>
<li><p>Strip whitespace and ensure proper case</p></li>
<li><p>Look up atomic number in preloaded mapping</p></li>
<li><p>Return atomic number as scalar integer</p></li>
</ul>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="rheedium.inout.kirkland_potentials">
<span class="sig-prename descclassname"><span class="pre">rheedium.inout.</span></span><span class="sig-name descname"><span class="pre">kirkland_potentials</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Float</span><span class="p"><span class="pre">[</span></span><span class="pre">Array</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'103</span> <span class="pre">12'</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/rheedium/inout/xyz.html#kirkland_potentials"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#rheedium.inout.kirkland_potentials" title="Link to this definition">¶</a></dt>
<dd><p>Returns preloaded Kirkland potential parameters as JAX array.</p>
<p>Data is loaded once at module import for optimal performance.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>kirkland_potentials</strong> – Kirkland potential parameters for elements 1-103</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Float[Array</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;</span> <span class="pre">103</span> <span class="pre">12&quot;</span></code><code class="xref py py-class docutils literal notranslate"><span class="pre">]</span></code></p>
</dd>
</dl>
<p class="rubric">Algorithm</p>
<ul class="simple">
<li><p>Return preloaded JAX array from module-level cache</p></li>
<li><p>No file I/O operations for fast access</p></li>
</ul>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="rheedium.inout.parse_xyz">
<span class="sig-prename descclassname"><span class="pre">rheedium.inout.</span></span><span class="sig-name descname"><span class="pre">parse_xyz</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file_path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/pathlib.html#pathlib.Path" title="(in Python v3.13)"><span class="pre">Path</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#rheedium.types.XYZData" title="rheedium.types.crystal_types.XYZData"><span class="pre">XYZData</span></a></span></span><a class="reference internal" href="_modules/rheedium/inout/xyz.html#parse_xyz"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#rheedium.inout.parse_xyz" title="Link to this definition">¶</a></dt>
<dd><p>Parses an XYZ file and returns a validated XYZData PyTree.</p>
<p>Supports both atomic symbols (e.g., “H”, “Fe”) and atomic numbers (e.g., “1”, “26”)
in the first column of atom data.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>file_path</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a> or <code class="xref py py-class docutils literal notranslate"><span class="pre">Path</span></code>) – Path to the XYZ file.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Validated JAX-compatible structure with all contents from the XYZ file.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">XYZData</span></code></p>
</dd>
</dl>
</dd></dl>

</section>
<section id="simulation-module">
<h2>Simulation Module<a class="headerlink" href="#simulation-module" title="Link to this heading">¶</a></h2>
<section id="module-simul">
<h3>Module: simul<a class="headerlink" href="#module-simul" title="Link to this heading">¶</a></h3>
<p>RHEED pattern simulation utilities.</p>
</section>
<section id="id1">
<h3>Functions<a class="headerlink" href="#id1" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><dl class="simple">
<dt><cite>wavelength_ang</cite>:</dt><dd><p>Calculate electron wavelength in angstroms</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><cite>incident_wavevector</cite>:</dt><dd><p>Calculate incident electron wavevector from beam parameters</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><cite>project_on_detector</cite>:</dt><dd><p>Project reciprocal lattice points onto detector screen</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><cite>find_kinematic_reflections</cite>:</dt><dd><p>Find kinematically allowed reflections for given experimental conditions</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><cite>compute_kinematic_intensities</cite>:</dt><dd><p>Calculate kinematic diffraction intensities for reciprocal lattice points</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><cite>simulate_rheed_pattern</cite>:</dt><dd><p>Complete RHEED pattern simulation from crystal structure to detector pattern</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><cite>atomic_potential</cite>:</dt><dd><p>Calculate atomic scattering potential for given atomic number</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><cite>crystal_potential</cite>:</dt><dd><p>Calculate multislice potential for a crystal structure</p>
</dd>
</dl>
</li>
</ul>
</section>
<p><strong>Functions:</strong></p>
<dl class="py function">
<dt class="sig sig-object py" id="rheedium.simul.wavelength_ang">
<span class="sig-prename descclassname"><span class="pre">rheedium.simul.</span></span><span class="sig-name descname"><span class="pre">wavelength_ang</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">voltage_kv</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><span class="pre">float</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Num</span><span class="p"><span class="pre">[</span></span><span class="pre">Array</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">''</span></span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Num</span><span class="p"><span class="pre">[</span></span><span class="pre">Array</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'...'</span></span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Float</span><span class="p"><span class="pre">[</span></span><span class="pre">Array</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'...'</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/rheedium/simul/simulator.html#wavelength_ang"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#rheedium.simul.wavelength_ang" title="Link to this definition">¶</a></dt>
<dd><p>Calculate the relativistic electron wavelength in angstroms.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>voltage_kV</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Union[scalar_num</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Num[Array</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;</span> <span class="pre">...&quot;</span></code><code class="xref py py-class docutils literal notranslate"><span class="pre">]]</span></code>) – Electron energy in kiloelectron volts.
Could be either a scalar or an array.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>wavelength_ang</strong> – Electron wavelength in angstroms</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Float[Array</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;</span> <span class="pre">...&quot;</span></code><code class="xref py py-class docutils literal notranslate"><span class="pre">]</span></code></p>
</dd>
</dl>
<div class="admonition-examples admonition">
<p class="admonition-title">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">jax.numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">jnp</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">rheedium</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">rh</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">energy</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">10.0</span><span class="p">,</span> <span class="mf">20.0</span><span class="p">,</span> <span class="mf">30.0</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">wavelengths</span> <span class="o">=</span> <span class="n">rh</span><span class="o">.</span><span class="n">simul</span><span class="o">.</span><span class="n">wavelength_ang</span><span class="p">(</span><span class="n">energy</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">wavelengths</span><span class="p">)</span>
<span class="go">[0.12204694 0.08588511 0.06979081]</span>
</pre></div>
</div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="rheedium.simul.incident_wavevector">
<span class="sig-prename descclassname"><span class="pre">rheedium.simul.</span></span><span class="sig-name descname"><span class="pre">incident_wavevector</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lam_ang</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><span class="pre">float</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Float</span><span class="p"><span class="pre">[</span></span><span class="pre">Array</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">''</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">theta_deg</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><span class="pre">float</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Float</span><span class="p"><span class="pre">[</span></span><span class="pre">Array</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">''</span></span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Float</span><span class="p"><span class="pre">[</span></span><span class="pre">Array</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'3'</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/rheedium/simul/simulator.html#incident_wavevector"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#rheedium.simul.incident_wavevector" title="Link to this definition">¶</a></dt>
<dd><p>Build an incident wavevector k_in with magnitude (2π / λ).</p>
<p>Traveling mostly along +x, with a small angle theta from the x-y plane.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>lam_ang</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a>) – Electron wavelength in angstroms</p></li>
<li><p><strong>theta_deg</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a>) – Grazing angle in degrees</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>k_in</strong> – The 3D incident wavevector (1/angstrom)</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Float[Array</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;</span> <span class="pre">3&quot;</span></code><code class="xref py py-class docutils literal notranslate"><span class="pre">]</span></code></p>
</dd>
</dl>
<div class="admonition-examples admonition">
<p class="admonition-title">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">rheedium</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">rh</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">jax.numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">jnp</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Calculate wavelength for 20 kV electrons</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">lam</span> <span class="o">=</span> <span class="n">rh</span><span class="o">.</span><span class="n">ucell</span><span class="o">.</span><span class="n">wavelength_ang</span><span class="p">(</span><span class="mf">20.0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Calculate incident wavevector at 2 degree grazing angle</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">k_in</span> <span class="o">=</span> <span class="n">rh</span><span class="o">.</span><span class="n">simul</span><span class="o">.</span><span class="n">incident_wavevector</span><span class="p">(</span><span class="n">lam</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Incident wavevector: </span><span class="si">{</span><span class="n">k_in</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p class="rubric">Algorithm</p>
<ul class="simple">
<li><p>Calculate wavevector magnitude as 2π/λ</p></li>
<li><p>Convert theta from degrees to radians</p></li>
<li><p>Calculate x-component using cosine of theta</p></li>
<li><p>Calculate z-component using negative sine of theta</p></li>
<li><p>Return 3D wavevector array with y-component as 0</p></li>
</ul>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="rheedium.simul.project_on_detector">
<span class="sig-prename descclassname"><span class="pre">rheedium.simul.</span></span><span class="sig-name descname"><span class="pre">project_on_detector</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">k_out_set</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Float</span><span class="p"><span class="pre">[</span></span><span class="pre">Array</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'M</span> <span class="pre">3'</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">detector_distance</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><span class="pre">float</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Float</span><span class="p"><span class="pre">[</span></span><span class="pre">Array</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">''</span></span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Float</span><span class="p"><span class="pre">[</span></span><span class="pre">Array</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'M</span> <span class="pre">2'</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/rheedium/simul/simulator.html#project_on_detector"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#rheedium.simul.project_on_detector" title="Link to this definition">¶</a></dt>
<dd><p>Project wavevectors k_out onto a plane at x = detector_distance.</p>
<p>Returns (M, 2) array of [Y, Z] coordinates on the detector.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>k_out_set</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Float[Array</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;</span> <span class="pre">M</span> <span class="pre">3&quot;</span></code><code class="xref py py-class docutils literal notranslate"><span class="pre">]</span></code>) – (M, 3) array of outgoing wavevectors</p></li>
<li><p><strong>detector_distance</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a>) – distance (in angstroms, or same unit) where screen is placed at x = L</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>coords</strong> – (M, 2) array of projected [Y, Z]</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Float[Array</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;</span> <span class="pre">M</span> <span class="pre">2&quot;</span></code><code class="xref py py-class docutils literal notranslate"><span class="pre">]</span></code></p>
</dd>
</dl>
<div class="admonition-examples admonition">
<p class="admonition-title">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">rheedium</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">rh</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">jax.numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">jnp</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Create some outgoing wavevectors</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">k_out</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">array</span><span class="p">([</span>
<span class="gp">... </span>    <span class="p">[</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">],</span>  <span class="c1"># First reflection</span>
<span class="gp">... </span>    <span class="p">[</span><span class="mf">1.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">],</span> <span class="c1"># Second reflection</span>
<span class="gp">... </span>    <span class="p">[</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.1</span><span class="p">]</span>  <span class="c1"># Third reflection</span>
<span class="gp">... </span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Project onto detector at 1000 Å distance</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">detector_points</span> <span class="o">=</span> <span class="n">rh</span><span class="o">.</span><span class="n">simul</span><span class="o">.</span><span class="n">project_on_detector</span><span class="p">(</span><span class="n">k_out</span><span class="p">,</span> <span class="mf">1000.0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Detector points: </span><span class="si">{</span><span class="n">detector_points</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p class="rubric">Algorithm</p>
<ul class="simple">
<li><p>Calculate norms of each wavevector</p></li>
<li><p>Normalize wavevectors to get unit directions</p></li>
<li><p>Calculate time parameter t for each ray to reach detector</p></li>
<li><p>Calculate Y coordinates using y-component of direction</p></li>
<li><p>Calculate Z coordinates using z-component of direction</p></li>
<li><p>Stack Y and Z coordinates into final array</p></li>
</ul>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="rheedium.simul.find_kinematic_reflections">
<span class="sig-prename descclassname"><span class="pre">rheedium.simul.</span></span><span class="sig-name descname"><span class="pre">find_kinematic_reflections</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">k_in</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Float</span><span class="p"><span class="pre">[</span></span><span class="pre">Array</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'3'</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Float</span><span class="p"><span class="pre">[</span></span><span class="pre">Array</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'M</span> <span class="pre">3'</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lam_ang</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Float</span><span class="p"><span class="pre">[</span></span><span class="pre">Array</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">''</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z_sign</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><span class="pre">float</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Float</span><span class="p"><span class="pre">[</span></span><span class="pre">Array</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">''</span></span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.13)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tolerance</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><span class="pre">float</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Float</span><span class="p"><span class="pre">[</span></span><span class="pre">Array</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">''</span></span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.13)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.05</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)"><span class="pre">tuple</span></a><span class="p"><span class="pre">[</span></span><span class="pre">Int</span><span class="p"><span class="pre">[</span></span><span class="pre">Array</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'K'</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Float</span><span class="p"><span class="pre">[</span></span><span class="pre">Array</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'K</span> <span class="pre">3'</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/rheedium/simul/simulator.html#find_kinematic_reflections"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#rheedium.simul.find_kinematic_reflections" title="Link to this definition">¶</a></dt>
<dd><p>Returns indices of G for which ||k_in + G|| ~ 2π/lam.</p>
<p>The z-component of (k_in + G) must have the specified sign.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>k_in</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Float[Array</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;</span> <span class="pre">3&quot;</span></code><code class="xref py py-class docutils literal notranslate"><span class="pre">]</span></code>) – shape (3,)</p></li>
<li><p><strong>Gs</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Float[Array</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;</span> <span class="pre">M</span> <span class="pre">3&quot;</span></code><code class="xref py py-class docutils literal notranslate"><span class="pre">]</span></code>) – G vector</p></li>
<li><p><strong>lam_ang</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Float[Array</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;</span> <span class="pre">&quot;</span></code><code class="xref py py-class docutils literal notranslate"><span class="pre">]</span></code>) – electron wavelength in Å</p></li>
<li><p><strong>z_sign</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a>, <em>optional</em>) – sign for z-component of k_out</p></li>
<li><p><strong>tolerance</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a>, <em>optional</em>) – how close to the Ewald sphere in 1/Å.
Default: 0.05</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>allowed_indices</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Int[Array</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;</span> <span class="pre">K&quot;</span></code><code class="xref py py-class docutils literal notranslate"><span class="pre">]</span></code>) – Allowed indices that will kinematically reflect.</p></li>
<li><p><strong>k_out</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Float[Array</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;</span> <span class="pre">K</span> <span class="pre">3&quot;</span></code><code class="xref py py-class docutils literal notranslate"><span class="pre">]</span></code>) – Outgoing wavevectors (in 1/Å) for those reflections.</p></li>
</ul>
</p>
</dd>
</dl>
<div class="admonition-examples admonition">
<p class="admonition-title">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">rheedium</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">rh</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">jax.numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">jnp</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Calculate incident wavevector</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">lam</span> <span class="o">=</span> <span class="n">rh</span><span class="o">.</span><span class="n">ucell</span><span class="o">.</span><span class="n">wavelength_ang</span><span class="p">(</span><span class="mf">20.0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">k_in</span> <span class="o">=</span> <span class="n">rh</span><span class="o">.</span><span class="n">simul</span><span class="o">.</span><span class="n">incident_wavevector</span><span class="p">(</span><span class="n">lam</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Generate some reciprocal lattice points</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Gs</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">array</span><span class="p">([</span>
<span class="gp">... </span>    <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>    <span class="c1"># (000)</span>
<span class="gp">... </span>    <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>    <span class="c1"># (100)</span>
<span class="gp">... </span>    <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>    <span class="c1"># (010)</span>
<span class="gp">... </span>    <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>     <span class="c1"># (110)</span>
<span class="gp">... </span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Find allowed reflections</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">indices</span><span class="p">,</span> <span class="n">k_out</span> <span class="o">=</span> <span class="n">rh</span><span class="o">.</span><span class="n">simul</span><span class="o">.</span><span class="n">find_kinematic_reflections</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">k_in</span><span class="o">=</span><span class="n">k_in</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">Gs</span><span class="o">=</span><span class="n">Gs</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">lam_ang</span><span class="o">=</span><span class="n">lam</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">tolerance</span><span class="o">=</span><span class="mf">0.1</span>  <span class="c1"># More lenient tolerance</span>
<span class="gp">... </span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Allowed indices: </span><span class="si">{</span><span class="n">indices</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Outgoing wavevectors: </span><span class="si">{</span><span class="n">k_out</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p class="rubric">Algorithm</p>
<ul class="simple">
<li><p>Calculate wavevector magnitude as 2π/λ</p></li>
<li><p>Calculate candidate outgoing wavevectors by adding k_in to each G</p></li>
<li><p>Calculate norms of candidate wavevectors</p></li>
<li><p>Create mask for wavevectors close to Ewald sphere</p></li>
<li><p>Create mask for wavevectors with correct z-sign</p></li>
<li><p>Combine masks to get final allowed indices</p></li>
<li><p>Return allowed indices and corresponding outgoing wavevectors</p></li>
</ul>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="rheedium.simul.compute_kinematic_intensities">
<span class="sig-prename descclassname"><span class="pre">rheedium.simul.</span></span><span class="sig-name descname"><span class="pre">compute_kinematic_intensities</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">positions</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Float</span><span class="p"><span class="pre">[</span></span><span class="pre">Array</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'N</span> <span class="pre">3'</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">g_allowed</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Float</span><span class="p"><span class="pre">[</span></span><span class="pre">Array</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'M</span> <span class="pre">3'</span></span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Float</span><span class="p"><span class="pre">[</span></span><span class="pre">Array</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'M'</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/rheedium/simul/simulator.html#compute_kinematic_intensities"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#rheedium.simul.compute_kinematic_intensities" title="Link to this definition">¶</a></dt>
<dd><p>Compute the kinematic intensity for each reflection.</p>
<p>Given the atomic Cartesian positions (N,3) and the
reciprocal vectors G_allowed (M,3), compute:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">I</span><span class="p">(</span><span class="n">G</span><span class="p">)</span> <span class="o">=</span> <span class="o">|</span> <span class="n">sum_j</span> <span class="n">exp</span><span class="p">(</span><span class="n">i</span> <span class="n">G·r_j</span><span class="p">)</span> <span class="o">|^</span><span class="mi">2</span>
</pre></div>
</div>
<p>ignoring atomic form factors, etc.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>positions</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Float[Array</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;</span> <span class="pre">N</span> <span class="pre">3&quot;</span></code><code class="xref py py-class docutils literal notranslate"><span class="pre">]</span></code>) – Atomic positions in Cartesian coordinates.</p></li>
<li><p><strong>G_allowed</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Float[Array</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;</span> <span class="pre">M</span> <span class="pre">3&quot;</span></code><code class="xref py py-class docutils literal notranslate"><span class="pre">]</span></code>) – Reciprocal lattice vectors that satisfy reflection condition.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>intensities</strong> – Intensities for each reflection.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Float[Array</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;</span> <span class="pre">M&quot;</span></code><code class="xref py py-class docutils literal notranslate"><span class="pre">]</span></code></p>
</dd>
</dl>
<div class="admonition-examples admonition">
<p class="admonition-title">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">rheedium</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">rh</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">jax.numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">jnp</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Create a simple unit cell with two atoms</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">positions</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">array</span><span class="p">([</span>
<span class="gp">... </span>    <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">],</span>  <span class="c1"># First atom at origin</span>
<span class="gp">... </span>    <span class="p">[</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">]</span>   <span class="c1"># Second atom at cell center</span>
<span class="gp">... </span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Define some allowed G vectors</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">G_allowed</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">array</span><span class="p">([</span>
<span class="gp">... </span>    <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>    <span class="c1"># (100)</span>
<span class="gp">... </span>    <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>    <span class="c1"># (010)</span>
<span class="gp">... </span>    <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>     <span class="c1"># (110)</span>
<span class="gp">... </span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Calculate intensities</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">intensities</span> <span class="o">=</span> <span class="n">rh</span><span class="o">.</span><span class="n">simul</span><span class="o">.</span><span class="n">compute_kinematic_intensities</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">positions</span><span class="o">=</span><span class="n">positions</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">G_allowed</span><span class="o">=</span><span class="n">G_allowed</span>
<span class="gp">... </span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Reflection intensities: </span><span class="si">{</span><span class="n">intensities</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p class="rubric">Algorithm</p>
<ul class="simple">
<li><p>Define inner function to compute intensity for single G vector</p></li>
<li><p>Calculate phase factors for each atom position</p></li>
<li><p>Sum real and imaginary parts of phase factors</p></li>
<li><p>Compute intensity as sum of squared real and imaginary parts</p></li>
<li><p>Vectorize computation over all allowed G vectors</p></li>
</ul>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="rheedium.simul.simulate_rheed_pattern">
<span class="sig-prename descclassname"><span class="pre">rheedium.simul.</span></span><span class="sig-name descname"><span class="pre">simulate_rheed_pattern</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">crystal</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#rheedium.types.CrystalStructure" title="rheedium.types.crystal_types.CrystalStructure"><span class="pre">CrystalStructure</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">voltage_kv</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><span class="pre">float</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Num</span><span class="p"><span class="pre">[</span></span><span class="pre">Array</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">''</span></span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.13)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">theta_deg</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><span class="pre">float</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Float</span><span class="p"><span class="pre">[</span></span><span class="pre">Array</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">''</span></span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.13)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hmax</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Integer</span><span class="p"><span class="pre">[</span></span><span class="pre">Array</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">''</span></span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.13)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kmax</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Integer</span><span class="p"><span class="pre">[</span></span><span class="pre">Array</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">''</span></span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.13)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lmax</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Integer</span><span class="p"><span class="pre">[</span></span><span class="pre">Array</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">''</span></span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.13)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tolerance</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><span class="pre">float</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Float</span><span class="p"><span class="pre">[</span></span><span class="pre">Array</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">''</span></span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.13)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.05</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">detector_distance</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><span class="pre">float</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Num</span><span class="p"><span class="pre">[</span></span><span class="pre">Array</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">''</span></span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.13)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1000.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z_sign</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><span class="pre">float</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Float</span><span class="p"><span class="pre">[</span></span><span class="pre">Array</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">''</span></span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.13)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pixel_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><span class="pre">float</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Float</span><span class="p"><span class="pre">[</span></span><span class="pre">Array</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">''</span></span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.13)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.1</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#rheedium.types.RHEEDPattern" title="rheedium.types.rheed_types.RHEEDPattern"><span class="pre">RHEEDPattern</span></a></span></span><a class="reference internal" href="_modules/rheedium/simul/simulator.html#simulate_rheed_pattern"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#rheedium.simul.simulate_rheed_pattern" title="Link to this definition">¶</a></dt>
<dd><p>Compute a kinematic RHEED pattern for the given crystal.</p>
<p>Uses atomic form factors from Kirkland potentials for realistic intensities.</p>
<p>This function combines several steps:
1. Generates reciprocal lattice points using <code class="xref py py-func docutils literal notranslate"><span class="pre">generate_reciprocal_points()</span></code>
2. Calculates incident wavevector using <a class="reference internal" href="#rheedium.simul.incident_wavevector" title="rheedium.simul.incident_wavevector"><code class="xref py py-func docutils literal notranslate"><span class="pre">incident_wavevector()</span></code></a>
3. Finds allowed reflections using <a class="reference internal" href="#rheedium.simul.find_kinematic_reflections" title="rheedium.simul.find_kinematic_reflections"><code class="xref py py-func docutils literal notranslate"><span class="pre">find_kinematic_reflections()</span></code></a>
4. Projects points onto detector using <a class="reference internal" href="#rheedium.simul.project_on_detector" title="rheedium.simul.project_on_detector"><code class="xref py py-func docutils literal notranslate"><span class="pre">project_on_detector()</span></code></a>
5. Computes intensities using atomic form factors from <a class="reference internal" href="#rheedium.simul.atomic_potential" title="rheedium.simul.atomic_potential"><code class="xref py py-func docutils literal notranslate"><span class="pre">atomic_potential()</span></code></a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>crystal</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">CrystalStructure</span></code>) – Crystal structure to simulate.
Can be created using <a class="reference internal" href="#rheedium.types.create_crystal_structure" title="rheedium.types.create_crystal_structure"><code class="xref py py-func docutils literal notranslate"><span class="pre">rheedium.types.create_crystal_structure()</span></code></a>
or loaded from a CIF file using <a class="reference internal" href="test_api.html#rheedium.inout.parse_cif" title="rheedium.inout.parse_cif"><code class="xref py py-func docutils literal notranslate"><span class="pre">rheedium.inout.parse_cif()</span></code></a></p></li>
<li><p><strong>voltage_kV</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">numeric</span></code>, <em>optional</em>) – Accelerating voltage in kilovolts.
Default: 10.0</p></li>
<li><p><strong>theta_deg</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a>, <em>optional</em>) – Grazing angle in degrees.
Default: 1.0</p></li>
<li><p><strong>hmax</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>, <em>optional</em>) – h Bound on reciprocal lattice indices.
Default is 3.</p></li>
<li><p><strong>kmax</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>, <em>optional</em>) – k Bound on reciprocal lattice indices.
Default is 3.</p></li>
<li><p><strong>lmax</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>, <em>optional</em>) – l Bound on reciprocal lattice indices.
Default is 1.</p></li>
<li><p><strong>tolerance</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a>, <em>optional</em>) – How close to the Ewald sphere in 1/Å.
Default: 0.05</p></li>
<li><p><strong>detector_distance</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a>, <em>optional</em>) – Distance from sample to detector plane in angstroms.
Default: 1000.0</p></li>
<li><p><strong>z_sign</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a>, <em>optional</em>) – If +1, keep reflections with positive z in k_out.
Default: 1.0</p></li>
<li><p><strong>pixel_size</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a>, <em>optional</em>) – Pixel size for atomic potential calculation in angstroms.
Default: 0.1</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>pattern</strong> – A NamedTuple capturing reflection indices, k_out, and detector coords.
Can be visualized using <a class="reference internal" href="#rheedium.plots.plot_rheed" title="rheedium.plots.plot_rheed"><code class="xref py py-func docutils literal notranslate"><span class="pre">rheedium.plots.plot_rheed()</span></code></a></p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">RHEEDPattern</span></code></p>
</dd>
</dl>
<div class="admonition-examples admonition">
<p class="admonition-title">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">rheedium</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">rh</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">jax.numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">jnp</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Load crystal structure from CIF file</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">crystal</span> <span class="o">=</span> <span class="n">rh</span><span class="o">.</span><span class="n">inout</span><span class="o">.</span><span class="n">parse_cif</span><span class="p">(</span><span class="s2">&quot;path/to/crystal.cif&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Simulate RHEED pattern</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pattern</span> <span class="o">=</span> <span class="n">rh</span><span class="o">.</span><span class="n">simul</span><span class="o">.</span><span class="n">simulate_rheed_pattern</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">crystal</span><span class="o">=</span><span class="n">crystal</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">voltage_kV</span><span class="o">=</span><span class="n">jnp</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="mf">20.0</span><span class="p">),</span>  <span class="c1"># 20 kV beam</span>
<span class="gp">... </span>    <span class="n">theta_deg</span><span class="o">=</span><span class="n">jnp</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="mf">2.0</span><span class="p">),</span>    <span class="c1"># 2 degree grazing angle</span>
<span class="gp">... </span>    <span class="n">hmax</span><span class="o">=</span><span class="n">jnp</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span>           <span class="c1"># Generate more reflections</span>
<span class="gp">... </span>    <span class="n">kmax</span><span class="o">=</span><span class="n">jnp</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span>
<span class="gp">... </span>    <span class="n">lmax</span><span class="o">=</span><span class="n">jnp</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">... </span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Plot the pattern</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rh</span><span class="o">.</span><span class="n">plots</span><span class="o">.</span><span class="n">plot_rheed</span><span class="p">(</span><span class="n">pattern</span><span class="p">,</span> <span class="n">grid_size</span><span class="o">=</span><span class="mi">400</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p class="rubric">Algorithm</p>
<ul class="simple">
<li><p>Build real-space cell vectors from cell parameters</p></li>
<li><p>Generate reciprocal lattice points up to specified bounds</p></li>
<li><p>Calculate electron wavelength from voltage</p></li>
<li><p>Build incident wavevector at specified angle</p></li>
<li><p>Find G vectors satisfying reflection condition</p></li>
<li><p>Project resulting k_out onto detector plane</p></li>
<li><p>Extract unique atomic numbers from crystal</p></li>
<li><p>Calculate atomic potentials for each element type</p></li>
<li><p>Compute structure factors with atomic form factors</p></li>
<li><p>Create and return RHEEDPattern with computed data</p></li>
</ul>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="rheedium.simul.atomic_potential">
<span class="sig-prename descclassname"><span class="pre">rheedium.simul.</span></span><span class="sig-name descname"><span class="pre">atomic_potential</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">atom_no</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Integer</span><span class="p"><span class="pre">[</span></span><span class="pre">Array</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">''</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pixel_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><span class="pre">float</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Float</span><span class="p"><span class="pre">[</span></span><span class="pre">Array</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">''</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grid_shape</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)"><span class="pre">tuple</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Integer</span><span class="p"><span class="pre">[</span></span><span class="pre">Array</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">''</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Integer</span><span class="p"><span class="pre">[</span></span><span class="pre">Array</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">''</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.13)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">center_coords</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Float</span><span class="p"><span class="pre">[</span></span><span class="pre">Array</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'2'</span></span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.13)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sampling</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Integer</span><span class="p"><span class="pre">[</span></span><span class="pre">Array</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">''</span></span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.13)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">16</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">potential_extent</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><span class="pre">float</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Float</span><span class="p"><span class="pre">[</span></span><span class="pre">Array</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">''</span></span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.13)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">4.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">datafile</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.13)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">str(DEFAULT_KIRKLAND_PATH)</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Float</span><span class="p"><span class="pre">[</span></span><span class="pre">Array</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'h</span> <span class="pre">w'</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/rheedium/simul/simulator.html#atomic_potential"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#rheedium.simul.atomic_potential" title="Link to this definition">¶</a></dt>
<dd><p>Calculate the projected potential of a single atom using Kirkland scattering factors.</p>
<p>The potential can be centered at arbitrary coordinates within a custom grid.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>atom_no</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>) – Atomic number of the atom whose potential is being calculated</p></li>
<li><p><strong>pixel_size</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a>) – Real space pixel size in Ångstroms</p></li>
<li><p><strong>grid_shape</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Tuple[scalar_int</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">scalar_int]</span></code>, <em>optional</em>) – Shape of the output grid (height, width). If None, calculated from potential_extent</p></li>
<li><p><strong>center_coords</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Float[Array</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;</span> <span class="pre">2&quot;</span></code><code class="xref py py-class docutils literal notranslate"><span class="pre">]</span></code>, <em>optional</em>) – (x, y) coordinates in Ångstroms where atom should be centered.
If None, centers at grid center</p></li>
<li><p><strong>sampling</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>, <em>optional</em>) – Supersampling factor for increased accuracy. Default is 16</p></li>
<li><p><strong>potential_extent</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a>, <em>optional</em>) – Distance in Ångstroms from atom center to calculate potential. Default is 4.0 Å</p></li>
<li><p><strong>datafile</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>, <em>optional</em>) – Path to CSV file containing Kirkland scattering factors</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>potential</strong> – Projected potential matrix with atom centered at specified coordinates</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Float[Array</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;</span> <span class="pre">h</span> <span class="pre">w&quot;</span></code><code class="xref py py-class docutils literal notranslate"><span class="pre">]</span></code></p>
</dd>
</dl>
<p class="rubric">Algorithm</p>
<ul class="simple">
<li><p>Define physical constants and load Kirkland parameters</p></li>
<li><p>Determine grid size and center coordinates</p></li>
<li><p>Calculate step size for supersampling</p></li>
<li><p>Create coordinate grid with atom centered at specified position</p></li>
<li><p>Calculate radial distances from atom center</p></li>
<li><p>Compute Bessel and Gaussian terms using Kirkland parameters</p></li>
<li><p>Combine terms to get total potential</p></li>
<li><p>Downsample to target resolution using average pooling</p></li>
<li><p>Return final potential matrix</p></li>
</ul>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="rheedium.simul.crystal_potential">
<span class="sig-prename descclassname"><span class="pre">rheedium.simul.</span></span><span class="sig-name descname"><span class="pre">crystal_potential</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">crystal</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#rheedium.types.CrystalStructure" title="rheedium.types.crystal_types.CrystalStructure"><span class="pre">CrystalStructure</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">slice_thickness</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><span class="pre">float</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Float</span><span class="p"><span class="pre">[</span></span><span class="pre">Array</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">''</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grid_shape</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)"><span class="pre">tuple</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Integer</span><span class="p"><span class="pre">[</span></span><span class="pre">Array</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">''</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Integer</span><span class="p"><span class="pre">[</span></span><span class="pre">Array</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">''</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">physical_extent</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)"><span class="pre">tuple</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><span class="pre">float</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Float</span><span class="p"><span class="pre">[</span></span><span class="pre">Array</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">''</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><span class="pre">float</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Float</span><span class="p"><span class="pre">[</span></span><span class="pre">Array</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">''</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pixel_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><span class="pre">float</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Float</span><span class="p"><span class="pre">[</span></span><span class="pre">Array</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">''</span></span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.13)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sampling</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Integer</span><span class="p"><span class="pre">[</span></span><span class="pre">Array</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">''</span></span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.13)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">16</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#rheedium.types.PotentialSlices" title="rheedium.types.crystal_types.PotentialSlices"><span class="pre">PotentialSlices</span></a></span></span><a class="reference internal" href="_modules/rheedium/simul/simulator.html#crystal_potential"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#rheedium.simul.crystal_potential" title="Link to this definition">¶</a></dt>
<dd><p>Calculate the multislice potential for a crystal structure.</p>
<p>Uses an optimized approach: compute atomic potentials once per unique atom type,
then use Fourier shifts to position them at their actual coordinates.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>crystal</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">CrystalStructure</span></code>) – Crystal structure to compute potential for</p></li>
<li><p><strong>slice_thickness</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a>) – Thickness of each slice in angstroms</p></li>
<li><p><strong>grid_shape</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Tuple[scalar_int</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">scalar_int]</span></code>) – Shape of the output grid (height, width) for each slice</p></li>
<li><p><strong>physical_extent</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Tuple[scalar_float</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">scalar_float]</span></code>) – Physical size of the grid (y_extent, x_extent) in angstroms</p></li>
<li><p><strong>pixel_size</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a>, <em>optional</em>) – Real space pixel size in angstroms.
Default: 0.1</p></li>
<li><p><strong>sampling</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>, <em>optional</em>) – Supersampling factor for potential calculation.
Default: 16</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>potential_slices</strong> – Structured potential data containing slice arrays and calibration information</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">PotentialSlices</span></code></p>
</dd>
</dl>
<p class="rubric">Algorithm</p>
<ul class="simple">
<li><p>Extract atomic positions and numbers from crystal structure</p></li>
<li><p>Find unique atomic numbers and compute their centered potentials once</p></li>
<li><p>Calculate z-range and determine number of slices needed</p></li>
<li><p>Calculate pixel calibrations and coordinate grids</p></li>
<li><dl class="simple">
<dt>For each slice:</dt><dd><ul>
<li><p>Find atoms within the slice boundaries</p></li>
<li><p>Group atoms by atomic number</p></li>
<li><dl class="simple">
<dt>For each unique atom type in slice:</dt><dd><ul>
<li><p>Use Fourier shifts to position atoms at their x,y coordinates</p></li>
<li><p>Sum shifted potentials for all atoms of this type</p></li>
</ul>
</dd>
</dl>
</li>
<li><p>Sum contributions from all atom types to get total slice potential</p></li>
</ul>
</dd>
</dl>
</li>
<li><p>Create PotentialSlices object with slice data and metadata</p></li>
<li><p>Return structured potential slices</p></li>
</ul>
</dd></dl>

</section>
<section id="unit-cell-module">
<h2>Unit Cell Module<a class="headerlink" href="#unit-cell-module" title="Link to this heading">¶</a></h2>
<section id="module-ucell">
<h3>Module: ucell<a class="headerlink" href="#module-ucell" title="Link to this heading">¶</a></h3>
<p>Unit cell and crystallographic utilities for RHEED simulation.</p>
</section>
<section id="id2">
<h3>Functions<a class="headerlink" href="#id2" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><dl class="simple">
<dt><cite>angle_in_degrees</cite>:</dt><dd><p>Calculate angle in degrees between two vectors</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><cite>compute_lengths_angles</cite>:</dt><dd><p>Extract lattice parameters from cell vectors</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><cite>parse_cif_and_scrape</cite>:</dt><dd><p>Parse CIF file and filter atoms within penetration depth</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><cite>reciprocal_unitcell</cite>:</dt><dd><p>Calculate reciprocal unit cell from direct cell vectors</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><cite>reciprocal_uc_angles</cite>:</dt><dd><p>Calculate reciprocal lattice parameters from direct parameters</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><cite>get_unit_cell_matrix</cite>:</dt><dd><p>Build transformation matrix from lattice parameters</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><cite>build_cell_vectors</cite>:</dt><dd><p>Convert lattice parameters to Cartesian cell vectors</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><cite>generate_reciprocal_points</cite>:</dt><dd><p>Generate reciprocal lattice points for given Miller indices</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><cite>atom_scraper</cite>:</dt><dd><p>Filter atoms within specified depth from surface along zone axis</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><cite>bessel_k0</cite>:</dt><dd><p>Modified Bessel function of second kind, order 0</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><cite>bessel_k1</cite>:</dt><dd><p>Modified Bessel function of second kind, order 1</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><cite>bessel_kv</cite>:</dt><dd><p>Modified Bessel function of second kind, arbitrary order</p>
</dd>
</dl>
</li>
</ul>
</section>
<p><strong>Functions:</strong></p>
<dl class="py function">
<dt class="sig sig-object py" id="rheedium.ucell.angle_in_degrees">
<span class="sig-prename descclassname"><span class="pre">rheedium.ucell.</span></span><span class="sig-name descname"><span class="pre">angle_in_degrees</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">v1</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Float</span><span class="p"><span class="pre">[</span></span><span class="pre">Array</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'n'</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">v2</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Float</span><span class="p"><span class="pre">[</span></span><span class="pre">Array</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'n'</span></span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Float</span><span class="p"><span class="pre">[</span></span><span class="pre">Array</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">''</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/rheedium/ucell/helper.html#angle_in_degrees"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#rheedium.ucell.angle_in_degrees" title="Link to this definition">¶</a></dt>
<dd><p>Calculate the angle in degrees between two vectors.</p>
<p>As long as the vectors have the same number of elements,
any dimensional vectors will work.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>v1</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Float[Array</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;</span> <span class="pre">n&quot;</span></code><code class="xref py py-class docutils literal notranslate"><span class="pre">]</span></code>) – First vector</p></li>
<li><p><strong>v2</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Float[Array</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;</span> <span class="pre">n&quot;</span></code><code class="xref py py-class docutils literal notranslate"><span class="pre">]</span></code>) – Second vector</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>angle</strong> – Angle between vectors in degrees</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Float[Array</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;</span> <span class="pre">&quot;</span></code><code class="xref py py-class docutils literal notranslate"><span class="pre">]</span></code></p>
</dd>
</dl>
<div class="admonition-examples admonition">
<p class="admonition-title">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">jax.numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">jnp</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">rheedium</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">rh</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">v1</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">v2</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">angle</span> <span class="o">=</span> <span class="n">rh</span><span class="o">.</span><span class="n">ucell</span><span class="o">.</span><span class="n">angle_in_degrees</span><span class="p">(</span><span class="n">v1</span><span class="p">,</span> <span class="n">v2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">angle</span><span class="p">)</span>
<span class="go">90.0</span>
</pre></div>
</div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="rheedium.ucell.compute_lengths_angles">
<span class="sig-prename descclassname"><span class="pre">rheedium.ucell.</span></span><span class="sig-name descname"><span class="pre">compute_lengths_angles</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">vectors</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Float</span><span class="p"><span class="pre">[</span></span><span class="pre">Array</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'3</span> <span class="pre">3'</span></span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)"><span class="pre">tuple</span></a><span class="p"><span class="pre">[</span></span><span class="pre">Float</span><span class="p"><span class="pre">[</span></span><span class="pre">Array</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'3'</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Float</span><span class="p"><span class="pre">[</span></span><span class="pre">Array</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'3'</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/rheedium/ucell/helper.html#compute_lengths_angles"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#rheedium.ucell.compute_lengths_angles" title="Link to this definition">¶</a></dt>
<dd><p>Compute unit cell lengths and angles from lattice vectors.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>vectors</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Float[Array</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;</span> <span class="pre">3</span> <span class="pre">3&quot;</span></code><code class="xref py py-class docutils literal notranslate"><span class="pre">]</span></code>) – Lattice vectors as rows of a 3x3 matrix</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>lengths</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Float[Array</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;</span> <span class="pre">3&quot;</span></code><code class="xref py py-class docutils literal notranslate"><span class="pre">]</span></code>) – Unit cell lengths in angstroms</p></li>
<li><p><strong>angles</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Float[Array</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;</span> <span class="pre">3&quot;</span></code><code class="xref py py-class docutils literal notranslate"><span class="pre">]</span></code>) – Unit cell angles in degrees</p></li>
</ul>
</p>
</dd>
</dl>
<div class="admonition-examples admonition">
<p class="admonition-title">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">jax.numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">jnp</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">rheedium</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">rh</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Cubic unit cell with a=5.0 Å</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vectors</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">array</span><span class="p">([</span>
<span class="gp">... </span>    <span class="p">[</span><span class="mf">5.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">],</span>
<span class="gp">... </span>    <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">5.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">],</span>
<span class="gp">... </span>    <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">5.0</span><span class="p">]</span>
<span class="gp">... </span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">lengths</span><span class="p">,</span> <span class="n">angles</span> <span class="o">=</span> <span class="n">rh</span><span class="o">.</span><span class="n">ucell</span><span class="o">.</span><span class="n">compute_lengths_angles</span><span class="p">(</span><span class="n">vectors</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">lengths</span><span class="p">)</span>
<span class="go">[5.0 5.0 5.0]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">angles</span><span class="p">)</span>
<span class="go">[90.0 90.0 90.0]</span>
</pre></div>
</div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="rheedium.ucell.parse_cif_and_scrape">
<span class="sig-prename descclassname"><span class="pre">rheedium.ucell.</span></span><span class="sig-name descname"><span class="pre">parse_cif_and_scrape</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cif_path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/pathlib.html#pathlib.Path" title="(in Python v3.13)"><span class="pre">Path</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">zone_axis</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Real</span><span class="p"><span class="pre">[</span></span><span class="pre">Array</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'3'</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">thickness_xyz</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Real</span><span class="p"><span class="pre">[</span></span><span class="pre">Array</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'3'</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tolerance</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><span class="pre">float</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Float</span><span class="p"><span class="pre">[</span></span><span class="pre">Array</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">''</span></span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.13)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1e-3</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#rheedium.types.CrystalStructure" title="rheedium.types.crystal_types.CrystalStructure"><span class="pre">CrystalStructure</span></a></span></span><a class="reference internal" href="_modules/rheedium/ucell/helper.html#parse_cif_and_scrape"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#rheedium.ucell.parse_cif_and_scrape" title="Link to this definition">¶</a></dt>
<dd><p>Parse a CIF file and filter atoms within specified thickness along a zone axis.</p>
<p>Parse a CIF file, apply symmetry operations to obtain all equivalent
atomic positions, and scrape (filter) atoms within specified thickness
along a given zone axis.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>cif_path</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Union[str</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Path]</span></code>) – Path to the CIF file.</p></li>
<li><p><strong>zone_axis</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Real[Array</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;</span> <span class="pre">3&quot;</span></code><code class="xref py py-class docutils literal notranslate"><span class="pre">]</span></code>) – Vector indicating the zone axis direction (surface normal) in
Cartesian coordinates.</p></li>
<li><p><strong>thickness_xyz</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Real[Array</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;</span> <span class="pre">3&quot;</span></code><code class="xref py py-class docutils literal notranslate"><span class="pre">]</span></code>) – Thickness along x, y, z directions in Ångstroms; currently,
only thickness_xyz[2] (z-direction)
is used to filter atoms along the provided zone axis.</p></li>
<li><p><strong>tolerance</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a>, <em>optional</em>) – Numerical tolerance parameter reserved for future use.
Default is 1e-3.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>filtered_crystal</strong> – Crystal structure containing atoms filtered within the specified thickness.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">CrystalStructure</span></code></p>
</dd>
</dl>
<div class="admonition-notes admonition">
<p class="admonition-title">Notes</p>
<ul class="simple">
<li><p>The provided <cite>zone_axis</cite> is normalized internally.</p></li>
<li><p>Current implementation uses thickness only along the zone axis
direction (z-component of <cite>thickness_xyz</cite>).</p></li>
<li><p>The <cite>tolerance</cite> parameter is reserved for compatibility and future
functionality.</p></li>
</ul>
</div>
<p class="rubric">Algorithm</p>
<ul class="simple">
<li><p>Parse CIF file to get initial crystal structure</p></li>
<li><p>Extract Cartesian positions and atomic numbers</p></li>
<li><p>Normalize zone axis vector</p></li>
<li><p>Calculate projections of atomic positions onto zone axis</p></li>
<li><p>Find minimum and maximum projections</p></li>
<li><p>Calculate center projection and half thickness</p></li>
<li><p>Create mask for atoms within thickness range</p></li>
<li><p>Filter Cartesian positions and atomic numbers using mask</p></li>
<li><p>Build cell vectors from crystal parameters</p></li>
<li><p>Calculate inverse of cell vectors</p></li>
<li><p>Convert filtered Cartesian positions to fractional coordinates</p></li>
<li><p>Create new CrystalStructure with filtered positions</p></li>
<li><p>Return filtered crystal structure</p></li>
</ul>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="rheedium.ucell.reciprocal_unitcell">
<span class="sig-prename descclassname"><span class="pre">rheedium.ucell.</span></span><span class="sig-name descname"><span class="pre">reciprocal_unitcell</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><span class="pre">float</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Float</span><span class="p"><span class="pre">[</span></span><span class="pre">Array</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">''</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><span class="pre">float</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Float</span><span class="p"><span class="pre">[</span></span><span class="pre">Array</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">''</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">c</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><span class="pre">float</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Float</span><span class="p"><span class="pre">[</span></span><span class="pre">Array</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">''</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><span class="pre">float</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Float</span><span class="p"><span class="pre">[</span></span><span class="pre">Array</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">''</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">beta</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><span class="pre">float</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Float</span><span class="p"><span class="pre">[</span></span><span class="pre">Array</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">''</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gamma</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><span class="pre">float</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Float</span><span class="p"><span class="pre">[</span></span><span class="pre">Array</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">''</span></span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)"><span class="pre">tuple</span></a><span class="p"><span class="pre">[</span></span><span class="pre">Float</span><span class="p"><span class="pre">[</span></span><span class="pre">Array</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'3'</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Float</span><span class="p"><span class="pre">[</span></span><span class="pre">Array</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'3'</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/rheedium/ucell/unitcell.html#reciprocal_unitcell"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#rheedium.ucell.reciprocal_unitcell" title="Link to this definition">¶</a></dt>
<dd><p>Calculate reciprocal unit cell parameters from direct cell parameters.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>a</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a>) – Direct cell lengths in angstroms.</p></li>
<li><p><strong>b</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a>) – Direct cell lengths in angstroms.</p></li>
<li><p><strong>c</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a>) – Direct cell lengths in angstroms.</p></li>
<li><p><strong>alpha</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a>) – Direct cell angles in degrees.</p></li>
<li><p><strong>beta</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a>) – Direct cell angles in degrees.</p></li>
<li><p><strong>gamma</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a>) – Direct cell angles in degrees.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Reciprocal cell lengths and angles. First array contains reciprocal cell lengths
[a*, b*, c*] in 1/angstroms. Second array contains reciprocal
cell angles [α*, β*, γ*] in degrees.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Tuple[Float[Array</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;</span> <span class="pre">3&quot;</span></code><code class="xref py py-class docutils literal notranslate"><span class="pre">]</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Float[Array</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;</span> <span class="pre">3&quot;</span></code><code class="xref py py-class docutils literal notranslate"><span class="pre">]]</span></code></p>
</dd>
</dl>
<p class="rubric">Algorithm</p>
<ul class="simple">
<li><p>Calculate cell volume from lattice parameters</p></li>
<li><p>Calculate reciprocal lengths using volume</p></li>
<li><p>Calculate reciprocal angles using direct angles</p></li>
<li><p>Return reciprocal parameters</p></li>
</ul>
<div class="admonition-examples admonition">
<p class="admonition-title">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">rheedium</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">rh</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">jax.numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">jnp</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Calculate reciprocal cell for a cubic unit cell</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_star</span><span class="p">,</span> <span class="n">angles_star</span> <span class="o">=</span> <span class="n">rh</span><span class="o">.</span><span class="n">ucell</span><span class="o">.</span><span class="n">reciprocal_unitcell</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">a</span><span class="o">=</span><span class="mf">3.0</span><span class="p">,</span> <span class="n">b</span><span class="o">=</span><span class="mf">3.0</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="mf">3.0</span><span class="p">,</span>  <span class="c1"># 3 Å cubic cell</span>
<span class="gp">... </span>    <span class="n">alpha</span><span class="o">=</span><span class="mf">90.0</span><span class="p">,</span> <span class="n">beta</span><span class="o">=</span><span class="mf">90.0</span><span class="p">,</span> <span class="n">gamma</span><span class="o">=</span><span class="mf">90.0</span>
<span class="gp">... </span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Reciprocal lengths: </span><span class="si">{</span><span class="n">a_star</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Reciprocal angles: </span><span class="si">{</span><span class="n">angles_star</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="rheedium.ucell.reciprocal_uc_angles">
<span class="sig-prename descclassname"><span class="pre">rheedium.ucell.</span></span><span class="sig-name descname"><span class="pre">reciprocal_uc_angles</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">alpha</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><span class="pre">float</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Float</span><span class="p"><span class="pre">[</span></span><span class="pre">Array</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">''</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">beta</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><span class="pre">float</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Float</span><span class="p"><span class="pre">[</span></span><span class="pre">Array</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">''</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gamma</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><span class="pre">float</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Float</span><span class="p"><span class="pre">[</span></span><span class="pre">Array</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">''</span></span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Float</span><span class="p"><span class="pre">[</span></span><span class="pre">Array</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'3'</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/rheedium/ucell/unitcell.html#reciprocal_uc_angles"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#rheedium.ucell.reciprocal_uc_angles" title="Link to this definition">¶</a></dt>
<dd><p>Calculate reciprocal unit cell angles from direct cell angles.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>alpha</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a>) – Direct cell angles in degrees.</p></li>
<li><p><strong>beta</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a>) – Direct cell angles in degrees.</p></li>
<li><p><strong>gamma</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a>) – Direct cell angles in degrees.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Reciprocal cell angles [α*, β*, γ*] in degrees.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Float[Array</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;</span> <span class="pre">3&quot;</span></code><code class="xref py py-class docutils literal notranslate"><span class="pre">]</span></code></p>
</dd>
</dl>
<p class="rubric">Algorithm</p>
<ul class="simple">
<li><p>Convert angles to radians</p></li>
<li><p>Calculate cosines of angles</p></li>
<li><p>Calculate reciprocal angles using arccos</p></li>
<li><p>Convert back to degrees</p></li>
<li><p>Return reciprocal angles</p></li>
</ul>
<div class="admonition-examples admonition">
<p class="admonition-title">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">rheedium</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">rh</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">jax.numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">jnp</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Calculate reciprocal angles for a cubic cell</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">angles_star</span> <span class="o">=</span> <span class="n">rh</span><span class="o">.</span><span class="n">ucell</span><span class="o">.</span><span class="n">reciprocal_uc_angles</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">alpha</span><span class="o">=</span><span class="mf">90.0</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">beta</span><span class="o">=</span><span class="mf">90.0</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">gamma</span><span class="o">=</span><span class="mf">90.0</span>
<span class="gp">... </span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Reciprocal angles: </span><span class="si">{</span><span class="n">angles_star</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="rheedium.ucell.get_unit_cell_matrix">
<span class="sig-prename descclassname"><span class="pre">rheedium.ucell.</span></span><span class="sig-name descname"><span class="pre">get_unit_cell_matrix</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><span class="pre">float</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Float</span><span class="p"><span class="pre">[</span></span><span class="pre">Array</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">''</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><span class="pre">float</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Float</span><span class="p"><span class="pre">[</span></span><span class="pre">Array</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">''</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">c</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><span class="pre">float</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Float</span><span class="p"><span class="pre">[</span></span><span class="pre">Array</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">''</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><span class="pre">float</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Float</span><span class="p"><span class="pre">[</span></span><span class="pre">Array</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">''</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">beta</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><span class="pre">float</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Float</span><span class="p"><span class="pre">[</span></span><span class="pre">Array</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">''</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gamma</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><span class="pre">float</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Float</span><span class="p"><span class="pre">[</span></span><span class="pre">Array</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">''</span></span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Float</span><span class="p"><span class="pre">[</span></span><span class="pre">Array</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'3</span> <span class="pre">3'</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/rheedium/ucell/unitcell.html#get_unit_cell_matrix"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#rheedium.ucell.get_unit_cell_matrix" title="Link to this definition">¶</a></dt>
<dd><p>Build transformation matrix between direct and reciprocal space.</p>
<blockquote>
<div><dl class="simple">
<dt>a, b, c<span class="classifier">scalar_float</span></dt><dd><p>Direct cell lengths in angstroms.</p>
</dd>
<dt>alpha, beta, gamma<span class="classifier">scalar_float</span></dt><dd><p>Direct cell angles in degrees.</p>
</dd>
</dl>
<dl class="simple">
<dt>Float[Array, “ 3 3”]</dt><dd><p>Transformation matrix from direct to reciprocal space.</p>
</dd>
</dl>
<ul class="simple">
<li><p>Calculate cell volume from lattice parameters</p></li>
<li><p>Calculate reciprocal lengths</p></li>
<li><p>Calculate transformation matrix elements</p></li>
<li><p>Return 3x3 transformation matrix</p></li>
</ul>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">rheedium</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">rh</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">jax.numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">jnp</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Get transformation matrix for a cubic cell</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">matrix</span> <span class="o">=</span> <span class="n">rh</span><span class="o">.</span><span class="n">ucell</span><span class="o">.</span><span class="n">get_unit_cell_matrix</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">a</span><span class="o">=</span><span class="mf">3.0</span><span class="p">,</span> <span class="n">b</span><span class="o">=</span><span class="mf">3.0</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="mf">3.0</span><span class="p">,</span>  <span class="c1"># 3 Å cubic cell</span>
<span class="gp">... </span>    <span class="n">alpha</span><span class="o">=</span><span class="mf">90.0</span><span class="p">,</span> <span class="n">beta</span><span class="o">=</span><span class="mf">90.0</span><span class="p">,</span> <span class="n">gamma</span><span class="o">=</span><span class="mf">90.0</span>
<span class="gp">... </span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Transformation matrix:</span>
</pre></div>
</div>
</div></blockquote>
<dl>
<dt>{matrix}”)</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Transform a direct space vector to reciprocal space</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">direct_vec</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">recip_vec</span> <span class="o">=</span> <span class="n">direct_vec</span> <span class="o">@</span> <span class="n">matrix</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Reciprocal vector: </span><span class="si">{</span><span class="n">recip_vec</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="rheedium.ucell.build_cell_vectors">
<span class="sig-prename descclassname"><span class="pre">rheedium.ucell.</span></span><span class="sig-name descname"><span class="pre">build_cell_vectors</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><span class="pre">float</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Float</span><span class="p"><span class="pre">[</span></span><span class="pre">Array</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">''</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><span class="pre">float</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Float</span><span class="p"><span class="pre">[</span></span><span class="pre">Array</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">''</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">c</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><span class="pre">float</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Float</span><span class="p"><span class="pre">[</span></span><span class="pre">Array</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">''</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><span class="pre">float</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Float</span><span class="p"><span class="pre">[</span></span><span class="pre">Array</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">''</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">beta</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><span class="pre">float</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Float</span><span class="p"><span class="pre">[</span></span><span class="pre">Array</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">''</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gamma</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><span class="pre">float</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Float</span><span class="p"><span class="pre">[</span></span><span class="pre">Array</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">''</span></span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Float</span><span class="p"><span class="pre">[</span></span><span class="pre">Array</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'3</span> <span class="pre">3'</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/rheedium/ucell/unitcell.html#build_cell_vectors"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#rheedium.ucell.build_cell_vectors" title="Link to this definition">¶</a></dt>
<dd><p>Construct unit cell vectors from lengths and angles.</p>
<blockquote>
<div><dl class="simple">
<dt>a, b, c<span class="classifier">scalar_float</span></dt><dd><p>Direct cell lengths in angstroms.</p>
</dd>
<dt>alpha, beta, gamma<span class="classifier">scalar_float</span></dt><dd><p>Direct cell angles in degrees.</p>
</dd>
</dl>
<dl class="simple">
<dt>Float[Array, “ 3 3”]</dt><dd><p>Unit cell vectors as rows of 3x3 matrix.</p>
</dd>
</dl>
<ul class="simple">
<li><p>Convert angles to radians</p></li>
<li><p>Calculate cosines of angles</p></li>
<li><p>Build first vector along x-axis</p></li>
<li><p>Build second vector in x-y plane</p></li>
<li><p>Build third vector using all angles</p></li>
<li><p>Return 3x3 matrix of vectors</p></li>
</ul>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">rheedium</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">rh</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">jax.numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">jnp</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Build vectors for a cubic cell</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vectors</span> <span class="o">=</span> <span class="n">rh</span><span class="o">.</span><span class="n">ucell</span><span class="o">.</span><span class="n">build_cell_vectors</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">a</span><span class="o">=</span><span class="mf">3.0</span><span class="p">,</span> <span class="n">b</span><span class="o">=</span><span class="mf">3.0</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="mf">3.0</span><span class="p">,</span>  <span class="c1"># 3 Å cubic cell</span>
<span class="gp">... </span>    <span class="n">alpha</span><span class="o">=</span><span class="mf">90.0</span><span class="p">,</span> <span class="n">beta</span><span class="o">=</span><span class="mf">90.0</span><span class="p">,</span> <span class="n">gamma</span><span class="o">=</span><span class="mf">90.0</span>
<span class="gp">... </span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Cell vectors:</span>
</pre></div>
</div>
</div></blockquote>
<dl>
<dt>{vectors}”)</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Calculate cell volume</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">volume</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">det</span><span class="p">(</span><span class="n">vectors</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Cell volume: </span><span class="si">{</span><span class="n">volume</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="rheedium.ucell.generate_reciprocal_points">
<span class="sig-prename descclassname"><span class="pre">rheedium.ucell.</span></span><span class="sig-name descname"><span class="pre">generate_reciprocal_points</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">crystal</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#rheedium.types.CrystalStructure" title="rheedium.types.crystal_types.CrystalStructure"><span class="pre">CrystalStructure</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">hmax</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Integer</span><span class="p"><span class="pre">[</span></span><span class="pre">Array</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">''</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kmax</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Integer</span><span class="p"><span class="pre">[</span></span><span class="pre">Array</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">''</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lmax</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Integer</span><span class="p"><span class="pre">[</span></span><span class="pre">Array</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">''</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">in_degrees</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Float</span><span class="p"><span class="pre">[</span></span><span class="pre">Array</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'M</span> <span class="pre">3'</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/rheedium/ucell/unitcell.html#generate_reciprocal_points"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#rheedium.ucell.generate_reciprocal_points" title="Link to this definition">¶</a></dt>
<dd><p>Generate reciprocal-lattice vectors based on the crystal structure.</p>
<blockquote>
<div><dl class="simple">
<dt>crystal<span class="classifier">CrystalStructure</span></dt><dd><p>Crystal structure to generate points for.</p>
</dd>
<dt>hmax, kmax, lmax<span class="classifier">scalar_int</span></dt><dd><p>Maximum h, k, l indices to generate.</p>
</dd>
<dt>in_degrees<span class="classifier">bool, optional</span></dt><dd><p>Whether to use degrees for angles. Default: True.</p>
</dd>
</dl>
<dl class="simple">
<dt>Float[Array, “ M 3”]</dt><dd><p>Reciprocal lattice vectors in 1/angstroms.</p>
</dd>
</dl>
<ul class="simple">
<li><p>Get cell parameters from crystal structure</p></li>
<li><p>Build transformation matrix</p></li>
<li><p>Generate h, k, l indices</p></li>
<li><p>Transform indices to reciprocal space</p></li>
<li><p>Return reciprocal vectors</p></li>
</ul>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">rheedium</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">rh</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">jax.numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">jnp</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Load crystal structure from CIF</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">crystal</span> <span class="o">=</span> <span class="n">rh</span><span class="o">.</span><span class="n">inout</span><span class="o">.</span><span class="n">parse_cif</span><span class="p">(</span><span class="s2">&quot;path/to/crystal.cif&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Generate reciprocal points up to (2,2,1)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">G_vectors</span> <span class="o">=</span> <span class="n">rh</span><span class="o">.</span><span class="n">ucell</span><span class="o">.</span><span class="n">generate_reciprocal_points</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">crystal</span><span class="o">=</span><span class="n">crystal</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">hmax</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">kmax</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">lmax</span><span class="o">=</span><span class="mi">1</span>
<span class="gp">... </span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Number of G vectors: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">G_vectors</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;First few G vectors:</span>
</pre></div>
</div>
</div></blockquote>
<p>{G_vectors[:5]}”)</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="rheedium.ucell.atom_scraper">
<span class="sig-prename descclassname"><span class="pre">rheedium.ucell.</span></span><span class="sig-name descname"><span class="pre">atom_scraper</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">crystal</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#rheedium.types.CrystalStructure" title="rheedium.types.crystal_types.CrystalStructure"><span class="pre">CrystalStructure</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">zone_axis</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Float</span><span class="p"><span class="pre">[</span></span><span class="pre">Array</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'3'</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">thickness</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Float</span><span class="p"><span class="pre">[</span></span><span class="pre">Array</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'3'</span></span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#rheedium.types.CrystalStructure" title="rheedium.types.crystal_types.CrystalStructure"><span class="pre">CrystalStructure</span></a></span></span><a class="reference internal" href="_modules/rheedium/ucell/unitcell.html#atom_scraper"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#rheedium.ucell.atom_scraper" title="Link to this definition">¶</a></dt>
<dd><p>Filter atoms within specified thickness along zone axis.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>crystal</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">CrystalStructure</span></code>) – Crystal structure to filter.</p></li>
<li><p><strong>zone_axis</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Float[Array</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;</span> <span class="pre">3&quot;</span></code><code class="xref py py-class docutils literal notranslate"><span class="pre">]</span></code>) – Zone axis direction.</p></li>
<li><p><strong>thickness</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Float[Array</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;</span> <span class="pre">3&quot;</span></code><code class="xref py py-class docutils literal notranslate"><span class="pre">]</span></code>) – Thickness in each direction.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Filtered crystal structure.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">CrystalStructure</span></code></p>
</dd>
</dl>
<p class="rubric">Algorithm</p>
<ul class="simple">
<li><p>Normalize zone axis</p></li>
<li><p>Calculate distances along zone axis</p></li>
<li><p>Filter atoms within thickness</p></li>
<li><p>Create new crystal structure with filtered atoms</p></li>
<li><p>Return filtered crystal</p></li>
</ul>
<div class="admonition-examples admonition">
<p class="admonition-title">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">rheedium</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">rh</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">jax.numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">jnp</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Load crystal structure</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">crystal</span> <span class="o">=</span> <span class="n">rh</span><span class="o">.</span><span class="n">inout</span><span class="o">.</span><span class="n">parse_cif</span><span class="p">(</span><span class="s2">&quot;path/to/crystal.cif&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Filter atoms within 12 Å along [111] direction</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">filtered</span> <span class="o">=</span> <span class="n">rh</span><span class="o">.</span><span class="n">ucell</span><span class="o">.</span><span class="n">atom_scraper</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">crystal</span><span class="o">=</span><span class="n">crystal</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">zone_axis</span><span class="o">=</span><span class="n">jnp</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">]),</span>
<span class="gp">... </span>    <span class="n">thickness</span><span class="o">=</span><span class="n">jnp</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">12.0</span><span class="p">,</span> <span class="mf">12.0</span><span class="p">,</span> <span class="mf">12.0</span><span class="p">])</span>
<span class="gp">... </span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Original atoms: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">crystal</span><span class="o">.</span><span class="n">frac_positions</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Filtered atoms: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">filtered</span><span class="o">.</span><span class="n">frac_positions</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="rheedium.ucell.bessel_kv">
<span class="sig-prename descclassname"><span class="pre">rheedium.ucell.</span></span><span class="sig-name descname"><span class="pre">bessel_kv</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">v</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><span class="pre">float</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Float</span><span class="p"><span class="pre">[</span></span><span class="pre">Array</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">''</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Float</span><span class="p"><span class="pre">[</span></span><span class="pre">Array</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'...'</span></span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Float</span><span class="p"><span class="pre">[</span></span><span class="pre">Array</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'...'</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/rheedium/ucell/bessel.html#bessel_kv"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#rheedium.ucell.bessel_kv" title="Link to this definition">¶</a></dt>
<dd><p>Computes the modified Bessel function of the second kind K_v(x).</p>
<p>Computes K_v(x) for real order v &gt;= 0 and x &gt; 0, using a numerically stable
and differentiable JAX-compatible approximation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>v</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a>) – Order of the Bessel function (v &gt;= 0).</p></li>
<li><p><strong>x</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Float[Array</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;</span> <span class="pre">...&quot;</span></code><code class="xref py py-class docutils literal notranslate"><span class="pre">]</span></code>) – Positive real input array.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>result</strong> – Approximated values of K_v(x)</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Float[Array</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;</span> <span class="pre">...&quot;</span></code><code class="xref py py-class docutils literal notranslate"><span class="pre">]</span></code></p>
</dd>
</dl>
<div class="admonition-notes admonition">
<p class="admonition-title">Notes</p>
<ul class="simple">
<li><p>Valid for v &gt;= 0 and x &gt; 0</p></li>
<li><p>Supports broadcasting and autodiff</p></li>
<li><p>JIT-safe and VMAP-safe</p></li>
<li><p>Uses series expansion for small x (x &lt;= 2.0) and asymptotic expansion
for large x</p></li>
<li><p>For non-integer v, uses the reflection formula:
K_v = π/(2sin(πv)) * (I_{-v} - I_v)</p></li>
<li><p>For integer v, uses specialized series expansions and recurrence relations</p></li>
<li><p>Special exact formula for v = 0.5: K_{1/2}(x) = sqrt(π/(2x)) * exp(-x)</p></li>
<li><p>The transition point between small and large x approximations is set
at x = 2.0</p></li>
</ul>
</div>
<p class="rubric">Algorithm</p>
<ul class="simple">
<li><p>For integer orders n &gt; 1, uses recurrence relations with masked updates
to only update values within the target range</p></li>
</ul>
</dd></dl>

</section>
<section id="types-module">
<h2>Types Module<a class="headerlink" href="#types-module" title="Link to this heading">¶</a></h2>
<section id="module-types">
<h3>Module: types<a class="headerlink" href="#module-types" title="Link to this heading">¶</a></h3>
<p>Custom types and data structures for RHEED simulation.</p>
</section>
<section id="classes">
<h3>Classes<a class="headerlink" href="#classes" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><dl class="simple">
<dt><cite>CrystalStructure</cite>:</dt><dd><p>JAX-compatible crystal structure with fractional and Cartesian coordinates</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><cite>PotentialSlices</cite>:</dt><dd><p>JAX-compatible data structure for representing multislice potential data</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><cite>RHEEDPattern</cite>:</dt><dd><p>Container for RHEED diffraction pattern data with detector points and intensities</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><cite>RHEEDImage</cite>:</dt><dd><p>Container for RHEED image data with pixel coordinates and intensity values</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><cite>XYZData</cite>:</dt><dd><p>A PyTree for XYZ file data with atomic positions, lattice vectors,
stress tensor, energy, properties, and comment</p>
</dd>
</dl>
</li>
</ul>
</section>
<section id="id3">
<h3>Functions<a class="headerlink" href="#id3" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><dl class="simple">
<dt><cite>create_crystal_structure</cite>:</dt><dd><p>Factory function to create CrystalStructure instances</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><cite>create_potential_slices</cite>:</dt><dd><p>Factory function to create PotentialSlices instances</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><cite>create_rheed_pattern</cite>:</dt><dd><p>Factory function to create RHEEDPattern instances</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><cite>create_rheed_image</cite>:</dt><dd><p>Factory function to create RHEEDImage instances</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><cite>make_xyz_data</cite>:</dt><dd><p>Factory function to create XYZData instances</p>
</dd>
</dl>
</li>
</ul>
</section>
<section id="type-aliases">
<h3>Type Aliases<a class="headerlink" href="#type-aliases" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><dl class="simple">
<dt><cite>scalar_float</cite>:</dt><dd><p>Union type for scalar float values (float or JAX scalar array)</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><cite>scalar_int</cite>:</dt><dd><p>Union type for scalar integer values (int or JAX scalar array)</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><cite>scalar_num</cite>:</dt><dd><p>Union type for scalar numeric values (int, float, or JAX scalar array)</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><cite>non_jax_number</cite>:</dt><dd><p>Union type for non-JAX numeric values (int or float)</p>
</dd>
</dl>
</li>
</ul>
</section>
<p><strong>Classes:</strong></p>
<dl class="py class">
<dt class="sig sig-object py" id="rheedium.types.CrystalStructure">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">rheedium.types.</span></span><span class="sig-name descname"><span class="pre">CrystalStructure</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">frac_positions</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Float</span><span class="p"><span class="pre">[</span></span><span class="pre">Array</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'N</span> <span class="pre">4'</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cart_positions</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Num</span><span class="p"><span class="pre">[</span></span><span class="pre">Array</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'N</span> <span class="pre">4'</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cell_lengths</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Num</span><span class="p"><span class="pre">[</span></span><span class="pre">Array</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'3'</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cell_angles</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Num</span><span class="p"><span class="pre">[</span></span><span class="pre">Array</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'3'</span></span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/rheedium/types/crystal_types.html#CrystalStructure"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#rheedium.types.CrystalStructure" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.NamedTuple" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">NamedTuple</span></code></a></p>
<p>JAX-compatible crystal structure with fractional and Cartesian coordinates.</p>
<p>This PyTree represents a crystal structure containing atomic positions in both
fractional and Cartesian coordinate systems, along with unit cell parameters.
It’s designed for efficient crystal structure calculations and electron
diffraction simulations.</p>
<dl>
<dt>Attributes:</dt><dd><dl class="simple">
<dt>frac_positions (Float[Array, “ N 4”]): Array of shape (n_atoms, 4) containing</dt><dd><p>atomic positions in fractional coordinates. Each row contains
[x, y, z, atomic_number] where x, y, z are fractional coordinates
in the unit cell (range [0,1]) and atomic_number is the integer
atomic number (Z) of the element.</p>
</dd>
<dt>cart_positions (Num[Array, “ N 4”]): Array of shape (n_atoms, 4) containing</dt><dd><p>atomic positions in Cartesian coordinates. Each row contains
[x, y, z, atomic_number] where x, y, z are Cartesian coordinates
in Ångstroms and atomic_number is the integer atomic number (Z).</p>
</dd>
</dl>
<p>cell_lengths (Num[Array, “ 3”]): Unit cell lengths [a, b, c] in Ångstroms.
cell_angles (Num[Array, “ 3”]): Unit cell angles [α, β, γ] in degrees,</p>
<blockquote>
<div><p>where α is the angle between b and c, β is the angle between a and c,
and γ is the angle between a and b.</p>
</div></blockquote>
</dd>
<dt>Note:</dt><dd><p>This class is registered as a PyTree node, making it compatible with JAX
transformations like jit, grad, and vmap. All data is immutable and stored
in JAX arrays for efficient computation.</p>
</dd>
<dt>Examples:</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">jax.numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">jnp</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">rheedium</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">rh</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Create crystal structure for simple cubic lattice</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">frac_pos</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mi">6</span><span class="p">]])</span>  <span class="c1"># Carbon atom at origin</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cart_pos</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mi">6</span><span class="p">]])</span>  <span class="c1"># Same in Cartesian</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cell_lengths</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">3.57</span><span class="p">,</span> <span class="mf">3.57</span><span class="p">,</span> <span class="mf">3.57</span><span class="p">])</span>  <span class="c1"># Diamond lattice</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cell_angles</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">90.0</span><span class="p">,</span> <span class="mf">90.0</span><span class="p">,</span> <span class="mf">90.0</span><span class="p">])</span>  <span class="c1"># Cubic angles</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">crystal</span> <span class="o">=</span> <span class="n">rh</span><span class="o">.</span><span class="n">types</span><span class="o">.</span><span class="n">create_crystal_structure</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">frac_positions</span><span class="o">=</span><span class="n">frac_pos</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">cart_positions</span><span class="o">=</span><span class="n">cart_pos</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">cell_lengths</span><span class="o">=</span><span class="n">cell_lengths</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">cell_angles</span><span class="o">=</span><span class="n">cell_angles</span>
<span class="gp">... </span><span class="p">)</span>
</pre></div>
</div>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="rheedium.types.CrystalStructure.frac_positions">
<span class="sig-name descname"><span class="pre">frac_positions</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">Float[Array,</span> <span class="pre">'N</span> <span class="pre">4']</span></code></em><a class="headerlink" href="#rheedium.types.CrystalStructure.frac_positions" title="Link to this definition">¶</a></dt>
<dd><p>Alias for field number 0</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="rheedium.types.CrystalStructure.cart_positions">
<span class="sig-name descname"><span class="pre">cart_positions</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">Num[Array,</span> <span class="pre">'N</span> <span class="pre">4']</span></code></em><a class="headerlink" href="#rheedium.types.CrystalStructure.cart_positions" title="Link to this definition">¶</a></dt>
<dd><p>Alias for field number 1</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="rheedium.types.CrystalStructure.cell_lengths">
<span class="sig-name descname"><span class="pre">cell_lengths</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">Num[Array,</span> <span class="pre">'3']</span></code></em><a class="headerlink" href="#rheedium.types.CrystalStructure.cell_lengths" title="Link to this definition">¶</a></dt>
<dd><p>Alias for field number 2</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="rheedium.types.CrystalStructure.cell_angles">
<span class="sig-name descname"><span class="pre">cell_angles</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">Num[Array,</span> <span class="pre">'3']</span></code></em><a class="headerlink" href="#rheedium.types.CrystalStructure.cell_angles" title="Link to this definition">¶</a></dt>
<dd><p>Alias for field number 3</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="rheedium.types.PotentialSlices">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">rheedium.types.</span></span><span class="sig-name descname"><span class="pre">PotentialSlices</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">slices</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Float</span><span class="p"><span class="pre">[</span></span><span class="pre">Array</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'n_slices</span> <span class="pre">height</span> <span class="pre">width'</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">slice_thickness</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><span class="pre">float</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Float</span><span class="p"><span class="pre">[</span></span><span class="pre">Array</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">''</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x_calibration</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><span class="pre">float</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Float</span><span class="p"><span class="pre">[</span></span><span class="pre">Array</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">''</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_calibration</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><span class="pre">float</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Float</span><span class="p"><span class="pre">[</span></span><span class="pre">Array</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">''</span></span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/rheedium/types/crystal_types.html#PotentialSlices"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#rheedium.types.PotentialSlices" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.NamedTuple" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">NamedTuple</span></code></a></p>
<p>JAX-compatible multislice potential data for electron beam propagation.</p>
<p>This PyTree represents discretized potential data used in multislice electron
diffraction calculations. It contains 3D potential slices with associated
calibration information for accurate physical modeling.</p>
<dl>
<dt>Attributes:</dt><dd><dl class="simple">
<dt>slices (Float[Array, “ n_slices height width”]): 3D array containing</dt><dd><p>potential data for each slice. First dimension indexes slices,
second and third dimensions are spatial coordinates.
Units: Volts or appropriate potential units.</p>
</dd>
<dt>slice_thickness (scalar_float): Thickness of each slice in Ångstroms.</dt><dd><p>Determines the z-spacing between consecutive slices.</p>
</dd>
<dt>x_calibration (scalar_float): Real space calibration in the x-direction</dt><dd><p>in Ångstroms per pixel. Converts pixel coordinates to physical distances.</p>
</dd>
<dt>y_calibration (scalar_float): Real space calibration in the y-direction</dt><dd><p>in Ångstroms per pixel. Converts pixel coordinates to physical distances.</p>
</dd>
</dl>
</dd>
<dt>Note:</dt><dd><p>This class is registered as a PyTree node, making it compatible with JAX
transformations like jit, grad, and vmap. The calibration metadata is
preserved as auxiliary data while slice data can be efficiently processed.
All data is immutable for functional programming patterns.</p>
</dd>
<dt>Examples:</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">jax.numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">jnp</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">rheedium</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">rh</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Create potential slices for multislice calculation</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">slices_data</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">10</span><span class="p">,</span> <span class="mi">64</span><span class="p">,</span> <span class="mi">64</span><span class="p">))</span>  <span class="c1"># 10 slices, 64x64 each</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">potential_slices</span> <span class="o">=</span> <span class="n">rh</span><span class="o">.</span><span class="n">types</span><span class="o">.</span><span class="n">create_potential_slices</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">slices</span><span class="o">=</span><span class="n">slices_data</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">slice_thickness</span><span class="o">=</span><span class="mf">2.0</span><span class="p">,</span>  <span class="c1"># 2 Å per slice</span>
<span class="gp">... </span>    <span class="n">x_calibration</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span>    <span class="c1"># 0.1 Å per pixel in x</span>
<span class="gp">... </span>    <span class="n">y_calibration</span><span class="o">=</span><span class="mf">0.1</span>     <span class="c1"># 0.1 Å per pixel in y</span>
<span class="gp">... </span><span class="p">)</span>
</pre></div>
</div>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="rheedium.types.PotentialSlices.slices">
<span class="sig-name descname"><span class="pre">slices</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">Float[Array,</span> <span class="pre">'n_slices</span> <span class="pre">height</span> <span class="pre">width']</span></code></em><a class="headerlink" href="#rheedium.types.PotentialSlices.slices" title="Link to this definition">¶</a></dt>
<dd><p>Alias for field number 0</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="rheedium.types.PotentialSlices.slice_thickness">
<span class="sig-name descname"><span class="pre">slice_thickness</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Union" title="(in Python v3.13)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code></a><span class="pre">[</span><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a><span class="pre">,</span> <code class="xref py py-class docutils literal notranslate"><span class="pre">Float[Array,</span> <span class="pre">'']</span></code><span class="pre">]</span></em><a class="headerlink" href="#rheedium.types.PotentialSlices.slice_thickness" title="Link to this definition">¶</a></dt>
<dd><p>Alias for field number 1</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="rheedium.types.PotentialSlices.x_calibration">
<span class="sig-name descname"><span class="pre">x_calibration</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Union" title="(in Python v3.13)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code></a><span class="pre">[</span><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a><span class="pre">,</span> <code class="xref py py-class docutils literal notranslate"><span class="pre">Float[Array,</span> <span class="pre">'']</span></code><span class="pre">]</span></em><a class="headerlink" href="#rheedium.types.PotentialSlices.x_calibration" title="Link to this definition">¶</a></dt>
<dd><p>Alias for field number 2</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="rheedium.types.PotentialSlices.y_calibration">
<span class="sig-name descname"><span class="pre">y_calibration</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Union" title="(in Python v3.13)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code></a><span class="pre">[</span><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a><span class="pre">,</span> <code class="xref py py-class docutils literal notranslate"><span class="pre">Float[Array,</span> <span class="pre">'']</span></code><span class="pre">]</span></em><a class="headerlink" href="#rheedium.types.PotentialSlices.y_calibration" title="Link to this definition">¶</a></dt>
<dd><p>Alias for field number 3</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="rheedium.types.XYZData">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">rheedium.types.</span></span><span class="sig-name descname"><span class="pre">XYZData</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">positions</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Float</span><span class="p"><span class="pre">[</span></span><span class="pre">Array</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'N</span> <span class="pre">3'</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">atomic_numbers</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Int</span><span class="p"><span class="pre">[</span></span><span class="pre">Array</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'N'</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lattice</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Float</span><span class="p"><span class="pre">[</span></span><span class="pre">Array</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'3</span> <span class="pre">3'</span></span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.13)"><span class="pre">None</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">stress</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Float</span><span class="p"><span class="pre">[</span></span><span class="pre">Array</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'3</span> <span class="pre">3'</span></span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.13)"><span class="pre">None</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">energy</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Float</span><span class="p"><span class="pre">[</span></span><span class="pre">Array</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">''</span></span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.13)"><span class="pre">None</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">properties</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><span class="pre">list</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)"><span class="pre">dict</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.13)"><span class="pre">None</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">comment</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.13)"><span class="pre">None</span></a></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/rheedium/types/crystal_types.html#XYZData"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#rheedium.types.XYZData" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.NamedTuple" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">NamedTuple</span></code></a></p>
<p>JAX-compatible representation of parsed XYZ file data.</p>
<p>This PyTree represents a complete XYZ file structure with atomic positions,
optional lattice information, and metadata. It’s designed for geometry
parsing, simulation preparation, and machine learning data processing.</p>
<dl>
<dt>Attributes:</dt><dd><dl class="simple">
<dt>positions (Float[Array, “ N 3”]): Cartesian atomic positions in Ångstroms.</dt><dd><p>Shape (N, 3) where N is the number of atoms.</p>
</dd>
<dt>atomic_numbers (Int[Array, “ N”]): Atomic numbers (Z) corresponding to</dt><dd><p>each atom. Shape (N,) with integer values.</p>
</dd>
<dt>lattice (Optional[Float[Array, “ 3 3”]]): Lattice vectors in Ångstroms</dt><dd><p>if present in the XYZ file, otherwise None. Shape (3, 3) matrix
where each row is a lattice vector.</p>
</dd>
<dt>stress (Optional[Float[Array, “ 3 3”]]): Symmetric stress tensor if</dt><dd><p>present in the metadata, otherwise None. Shape (3, 3) matrix
with stress components.</p>
</dd>
<dt>energy (Optional[scalar_float]): Total energy in eV if present in</dt><dd><p>the metadata, otherwise None. Scalar value.</p>
</dd>
<dt>properties (Optional[List[Dict[str, Union[str, int]]]]): List of</dt><dd><p>per-atom properties described in the metadata, otherwise None.</p>
</dd>
<dt>comment (Optional[str]): The raw comment line from the XYZ file</dt><dd><p>header, otherwise None.</p>
</dd>
</dl>
</dd>
<dt>Note:</dt><dd><p>This class is registered as a PyTree node, making it compatible with JAX
transformations like jit, grad, and vmap. Numerical data is stored as
JAX arrays while metadata is preserved as auxiliary data. All data is
immutable for functional programming patterns.</p>
</dd>
<dt>Examples:</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">jax.numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">jnp</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">rheedium</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">rh</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Create XYZ data for water molecule</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">positions</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.76</span><span class="p">,</span> <span class="mf">0.59</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="mf">0.76</span><span class="p">,</span> <span class="mf">0.59</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">atomic_numbers</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">8</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>  <span class="c1"># O, H, H</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">xyz_data</span> <span class="o">=</span> <span class="n">rh</span><span class="o">.</span><span class="n">types</span><span class="o">.</span><span class="n">make_xyz_data</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">positions</span><span class="o">=</span><span class="n">positions</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">atomic_numbers</span><span class="o">=</span><span class="n">atomic_numbers</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">comment</span><span class="o">=</span><span class="s2">&quot;Water molecule&quot;</span>
<span class="gp">... </span><span class="p">)</span>
</pre></div>
</div>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="rheedium.types.XYZData.positions">
<span class="sig-name descname"><span class="pre">positions</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">Float[Array,</span> <span class="pre">'N</span> <span class="pre">3']</span></code></em><a class="headerlink" href="#rheedium.types.XYZData.positions" title="Link to this definition">¶</a></dt>
<dd><p>Alias for field number 0</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="rheedium.types.XYZData.atomic_numbers">
<span class="sig-name descname"><span class="pre">atomic_numbers</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">Int[Array,</span> <span class="pre">'N']</span></code></em><a class="headerlink" href="#rheedium.types.XYZData.atomic_numbers" title="Link to this definition">¶</a></dt>
<dd><p>Alias for field number 1</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="rheedium.types.XYZData.lattice">
<span class="sig-name descname"><span class="pre">lattice</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.13)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code></a><span class="pre">[</span><code class="xref py py-class docutils literal notranslate"><span class="pre">Float[Array,</span> <span class="pre">'3</span> <span class="pre">3']</span></code><span class="pre">]</span></em><a class="headerlink" href="#rheedium.types.XYZData.lattice" title="Link to this definition">¶</a></dt>
<dd><p>Alias for field number 2</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="rheedium.types.XYZData.stress">
<span class="sig-name descname"><span class="pre">stress</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.13)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code></a><span class="pre">[</span><code class="xref py py-class docutils literal notranslate"><span class="pre">Float[Array,</span> <span class="pre">'3</span> <span class="pre">3']</span></code><span class="pre">]</span></em><a class="headerlink" href="#rheedium.types.XYZData.stress" title="Link to this definition">¶</a></dt>
<dd><p>Alias for field number 3</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="rheedium.types.XYZData.energy">
<span class="sig-name descname"><span class="pre">energy</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.13)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code></a><span class="pre">[</span><code class="xref py py-class docutils literal notranslate"><span class="pre">Float[Array,</span> <span class="pre">'']</span></code><span class="pre">]</span></em><a class="headerlink" href="#rheedium.types.XYZData.energy" title="Link to this definition">¶</a></dt>
<dd><p>Alias for field number 4</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="rheedium.types.XYZData.properties">
<span class="sig-name descname"><span class="pre">properties</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.13)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code></a><span class="pre">[</span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code></a><span class="pre">[</span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code></a><span class="pre">[</span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a><span class="pre">,</span> <a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Union" title="(in Python v3.13)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code></a><span class="pre">[</span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a><span class="pre">,</span> <a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a><span class="pre">]]]]</span></em><a class="headerlink" href="#rheedium.types.XYZData.properties" title="Link to this definition">¶</a></dt>
<dd><p>Alias for field number 5</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="rheedium.types.XYZData.comment">
<span class="sig-name descname"><span class="pre">comment</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.13)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code></a><span class="pre">[</span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a><span class="pre">]</span></em><a class="headerlink" href="#rheedium.types.XYZData.comment" title="Link to this definition">¶</a></dt>
<dd><p>Alias for field number 6</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="rheedium.types.RHEEDPattern">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">rheedium.types.</span></span><span class="sig-name descname"><span class="pre">RHEEDPattern</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">G_indices</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Int</span><span class="p"><span class="pre">[</span></span><span class="pre">Array</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'N'</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">k_out</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Float</span><span class="p"><span class="pre">[</span></span><span class="pre">Array</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'M</span> <span class="pre">3'</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">detector_points</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Float</span><span class="p"><span class="pre">[</span></span><span class="pre">Array</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'M</span> <span class="pre">2'</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">intensities</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Float</span><span class="p"><span class="pre">[</span></span><span class="pre">Array</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'M'</span></span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/rheedium/types/rheed_types.html#RHEEDPattern"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#rheedium.types.RHEEDPattern" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.NamedTuple" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">NamedTuple</span></code></a></p>
<p>JAX-compatible RHEED diffraction pattern data structure.</p>
<p>This PyTree represents a RHEED diffraction pattern containing reflection
data including reciprocal lattice indices, outgoing wavevectors, detector
coordinates, and intensity values for electron diffraction analysis.</p>
<dl>
<dt>Attributes:</dt><dd><dl class="simple">
<dt>G_indices (Int[Array, “ N”]): Indices of reciprocal-lattice vectors</dt><dd><p>that satisfy reflection conditions. Variable length array of
integer indices.</p>
</dd>
<dt>k_out (Float[Array, “ M 3”]): Outgoing wavevectors in 1/Å for</dt><dd><p>reflections. Shape (M, 3) where M is the number of reflections
and each row contains [kx, ky, kz] components.</p>
</dd>
<dt>detector_points (Float[Array, “ M 2”]): Detector coordinates (Y, Z)</dt><dd><p>on the detector plane in Ångstroms. Shape (M, 2) where each
row contains [y, z] coordinates.</p>
</dd>
<dt>intensities (Float[Array, “ M”]): Intensity values for each reflection.</dt><dd><p>Shape (M,) with non-negative intensity values.</p>
</dd>
</dl>
</dd>
<dt>Note:</dt><dd><p>This class is registered as a PyTree node, making it compatible with JAX
transformations like jit, grad, and vmap. All data is immutable and
stored in JAX arrays for efficient RHEED pattern analysis.</p>
</dd>
<dt>Examples:</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">jax.numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">jnp</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">rheedium</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">rh</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Create RHEED pattern data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">G_indices</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">k_out</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">],</span> <span class="p">[</span><span class="mf">2.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">],</span> <span class="p">[</span><span class="mf">3.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">detector_points</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">10.0</span><span class="p">,</span> <span class="mf">5.0</span><span class="p">],</span> <span class="p">[</span><span class="mf">20.0</span><span class="p">,</span> <span class="mf">10.0</span><span class="p">],</span> <span class="p">[</span><span class="mf">30.0</span><span class="p">,</span> <span class="mf">15.0</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">intensities</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">100.0</span><span class="p">,</span> <span class="mf">80.0</span><span class="p">,</span> <span class="mf">60.0</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pattern</span> <span class="o">=</span> <span class="n">rh</span><span class="o">.</span><span class="n">types</span><span class="o">.</span><span class="n">create_rheed_pattern</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">G_indices</span><span class="o">=</span><span class="n">G_indices</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">k_out</span><span class="o">=</span><span class="n">k_out</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">detector_points</span><span class="o">=</span><span class="n">detector_points</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">intensities</span><span class="o">=</span><span class="n">intensities</span>
<span class="gp">... </span><span class="p">)</span>
</pre></div>
</div>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="rheedium.types.RHEEDPattern.G_indices">
<span class="sig-name descname"><span class="pre">G_indices</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">Int[Array,</span> <span class="pre">'N']</span></code></em><a class="headerlink" href="#rheedium.types.RHEEDPattern.G_indices" title="Link to this definition">¶</a></dt>
<dd><p>Alias for field number 0</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="rheedium.types.RHEEDPattern.k_out">
<span class="sig-name descname"><span class="pre">k_out</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">Float[Array,</span> <span class="pre">'M</span> <span class="pre">3']</span></code></em><a class="headerlink" href="#rheedium.types.RHEEDPattern.k_out" title="Link to this definition">¶</a></dt>
<dd><p>Alias for field number 1</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="rheedium.types.RHEEDPattern.detector_points">
<span class="sig-name descname"><span class="pre">detector_points</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">Float[Array,</span> <span class="pre">'M</span> <span class="pre">2']</span></code></em><a class="headerlink" href="#rheedium.types.RHEEDPattern.detector_points" title="Link to this definition">¶</a></dt>
<dd><p>Alias for field number 2</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="rheedium.types.RHEEDPattern.intensities">
<span class="sig-name descname"><span class="pre">intensities</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">Float[Array,</span> <span class="pre">'M']</span></code></em><a class="headerlink" href="#rheedium.types.RHEEDPattern.intensities" title="Link to this definition">¶</a></dt>
<dd><p>Alias for field number 3</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="rheedium.types.RHEEDImage">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">rheedium.types.</span></span><span class="sig-name descname"><span class="pre">RHEEDImage</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">img_array</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Float</span><span class="p"><span class="pre">[</span></span><span class="pre">Array</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'H</span> <span class="pre">W'</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">incoming_angle</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><span class="pre">float</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Float</span><span class="p"><span class="pre">[</span></span><span class="pre">Array</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">''</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">calibration</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Float</span><span class="p"><span class="pre">[</span></span><span class="pre">Array</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'2'</span></span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><span class="pre">float</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Float</span><span class="p"><span class="pre">[</span></span><span class="pre">Array</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">''</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">electron_wavelength</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><span class="pre">float</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Float</span><span class="p"><span class="pre">[</span></span><span class="pre">Array</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">''</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">detector_distance</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><span class="pre">float</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Num</span><span class="p"><span class="pre">[</span></span><span class="pre">Array</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">''</span></span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/rheedium/types/rheed_types.html#RHEEDImage"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#rheedium.types.RHEEDImage" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.NamedTuple" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">NamedTuple</span></code></a></p>
<p>JAX-compatible experimental RHEED image data structure.</p>
<p>This PyTree represents an experimental RHEED image with associated
experimental parameters including beam geometry, detector calibration,
and electron beam properties for quantitative RHEED analysis.</p>
<dl>
<dt>Attributes:</dt><dd><dl class="simple">
<dt>img_array (Float[Array, “ H W”]): 2D image array with shape (height, width)</dt><dd><p>containing pixel intensity values. Non-negative finite values.</p>
</dd>
<dt>incoming_angle (scalar_float): Angle of the incoming electron beam</dt><dd><p>in degrees, typically between 0 and 90 degrees for grazing
incidence geometry.</p>
</dd>
<dt>calibration (Union[Float[Array, “ 2”], scalar_float]): Calibration factor</dt><dd><p>for converting pixels to physical units. Either a scalar (same
calibration for both axes) or array of shape (2,) with separate
[x, y] calibrations in appropriate units per pixel.</p>
</dd>
<dt>electron_wavelength (scalar_float): Wavelength of the electrons in</dt><dd><p>Ångstroms. Determines the diffraction geometry and resolution.</p>
</dd>
<dt>detector_distance (scalar_float): Distance from the sample to the</dt><dd><p>detector in Ångstroms. Affects the angular resolution and
reciprocal space mapping.</p>
</dd>
</dl>
</dd>
<dt>Note:</dt><dd><p>This class is registered as a PyTree node, making it compatible with JAX
transformations like jit, grad, and vmap. All data is immutable for
functional programming patterns and efficient image processing.</p>
</dd>
<dt>Examples:</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">jax.numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">jnp</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">rheedium</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">rh</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Create RHEED image with experimental parameters</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">image</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="mi">256</span><span class="p">,</span> <span class="mi">512</span><span class="p">))</span>  <span class="c1"># 256x512 pixel RHEED image</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rheed_img</span> <span class="o">=</span> <span class="n">rh</span><span class="o">.</span><span class="n">types</span><span class="o">.</span><span class="n">create_rheed_image</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">img_array</span><span class="o">=</span><span class="n">image</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">incoming_angle</span><span class="o">=</span><span class="mf">2.0</span><span class="p">,</span>  <span class="c1"># 2 degree grazing angle</span>
<span class="gp">... </span>    <span class="n">calibration</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span>    <span class="c1"># 0.01 units per pixel</span>
<span class="gp">... </span>    <span class="n">electron_wavelength</span><span class="o">=</span><span class="mf">0.037</span><span class="p">,</span>  <span class="c1"># 10 keV electrons</span>
<span class="gp">... </span>    <span class="n">detector_distance</span><span class="o">=</span><span class="mf">1000.0</span>     <span class="c1"># 1000 Å to detector</span>
<span class="gp">... </span><span class="p">)</span>
</pre></div>
</div>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="rheedium.types.RHEEDImage.img_array">
<span class="sig-name descname"><span class="pre">img_array</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">Float[Array,</span> <span class="pre">'H</span> <span class="pre">W']</span></code></em><a class="headerlink" href="#rheedium.types.RHEEDImage.img_array" title="Link to this definition">¶</a></dt>
<dd><p>Alias for field number 0</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="rheedium.types.RHEEDImage.incoming_angle">
<span class="sig-name descname"><span class="pre">incoming_angle</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Union" title="(in Python v3.13)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code></a><span class="pre">[</span><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a><span class="pre">,</span> <code class="xref py py-class docutils literal notranslate"><span class="pre">Float[Array,</span> <span class="pre">'']</span></code><span class="pre">]</span></em><a class="headerlink" href="#rheedium.types.RHEEDImage.incoming_angle" title="Link to this definition">¶</a></dt>
<dd><p>Alias for field number 1</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="rheedium.types.RHEEDImage.calibration">
<span class="sig-name descname"><span class="pre">calibration</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Union" title="(in Python v3.13)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code></a><span class="pre">[</span><code class="xref py py-class docutils literal notranslate"><span class="pre">Float[Array,</span> <span class="pre">'2']</span></code><span class="pre">,</span> <a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a><span class="pre">,</span> <code class="xref py py-class docutils literal notranslate"><span class="pre">Float[Array,</span> <span class="pre">'']</span></code><span class="pre">]</span></em><a class="headerlink" href="#rheedium.types.RHEEDImage.calibration" title="Link to this definition">¶</a></dt>
<dd><p>Alias for field number 2</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="rheedium.types.RHEEDImage.electron_wavelength">
<span class="sig-name descname"><span class="pre">electron_wavelength</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Union" title="(in Python v3.13)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code></a><span class="pre">[</span><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a><span class="pre">,</span> <code class="xref py py-class docutils literal notranslate"><span class="pre">Float[Array,</span> <span class="pre">'']</span></code><span class="pre">]</span></em><a class="headerlink" href="#rheedium.types.RHEEDImage.electron_wavelength" title="Link to this definition">¶</a></dt>
<dd><p>Alias for field number 3</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="rheedium.types.RHEEDImage.detector_distance">
<span class="sig-name descname"><span class="pre">detector_distance</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Union" title="(in Python v3.13)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code></a><span class="pre">[</span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a><span class="pre">,</span> <a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a><span class="pre">,</span> <code class="xref py py-class docutils literal notranslate"><span class="pre">Num[Array,</span> <span class="pre">'']</span></code><span class="pre">]</span></em><a class="headerlink" href="#rheedium.types.RHEEDImage.detector_distance" title="Link to this definition">¶</a></dt>
<dd><p>Alias for field number 4</p>
</dd></dl>

</dd></dl>

<p><strong>Factory Functions:</strong></p>
<dl class="py function">
<dt class="sig sig-object py" id="rheedium.types.make_xyz_data">
<span class="sig-prename descclassname"><span class="pre">rheedium.types.</span></span><span class="sig-name descname"><span class="pre">make_xyz_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">positions</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Float</span><span class="p"><span class="pre">[</span></span><span class="pre">Array</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'N</span> <span class="pre">3'</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">atomic_numbers</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Int</span><span class="p"><span class="pre">[</span></span><span class="pre">Array</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'N'</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lattice</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Float</span><span class="p"><span class="pre">[</span></span><span class="pre">Array</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'3</span> <span class="pre">3'</span></span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.13)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stress</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Float</span><span class="p"><span class="pre">[</span></span><span class="pre">Array</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'3</span> <span class="pre">3'</span></span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.13)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">energy</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><span class="pre">float</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Float</span><span class="p"><span class="pre">[</span></span><span class="pre">Array</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">''</span></span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.13)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">properties</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><span class="pre">list</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)"><span class="pre">dict</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.13)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">comment</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.13)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#rheedium.types.XYZData" title="rheedium.types.crystal_types.XYZData"><span class="pre">XYZData</span></a></span></span><a class="reference internal" href="_modules/rheedium/types/crystal_types.html#make_xyz_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#rheedium.types.make_xyz_data" title="Link to this definition">¶</a></dt>
<dd><p>JAX-safe factory function for XYZData with runtime validation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>positions</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Float[Array</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;</span> <span class="pre">N</span> <span class="pre">3&quot;</span></code><code class="xref py py-class docutils literal notranslate"><span class="pre">]</span></code>) – Cartesian positions in Ångstroms.</p></li>
<li><p><strong>atomic_numbers</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Int[Array</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;</span> <span class="pre">N&quot;</span></code><code class="xref py py-class docutils literal notranslate"><span class="pre">]</span></code>) – Atomic numbers (Z) for each atom.</p></li>
<li><p><strong>lattice</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Optional[Float[Array</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;</span> <span class="pre">3</span> <span class="pre">3&quot;</span></code><code class="xref py py-class docutils literal notranslate"><span class="pre">]]</span></code>, <em>optional</em>) – Lattice vectors (if any).</p></li>
<li><p><strong>stress</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Optional[Float[Array</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;</span> <span class="pre">3</span> <span class="pre">3&quot;</span></code><code class="xref py py-class docutils literal notranslate"><span class="pre">]]</span></code>, <em>optional</em>) – Stress tensor (if any).</p></li>
<li><p><strong>energy</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Optional[scalar_float]</span></code>, <em>optional</em>) – Total energy (if any).</p></li>
<li><p><strong>properties</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Optional[List[Dict[str</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Union[str</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">int]]]]</span></code>, <em>optional</em>) – Per-atom metadata.</p></li>
<li><p><strong>comment</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Optional[str]</span></code>, <em>optional</em>) – Original XYZ comment line.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Validated PyTree structure for XYZ file contents.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#rheedium.types.XYZData" title="rheedium.types.XYZData"><code class="xref py py-class docutils literal notranslate"><span class="pre">XYZData</span></code></a></p>
</dd>
</dl>
<p class="rubric">Algorithm</p>
<ul class="simple">
<li><p>Convert required inputs to JAX arrays with appropriate dtypes:
positions to float64, atomic_numbers to int32, lattice/stress/energy
to float64 if provided</p></li>
<li><p>Execute shape validation checks: verify positions has shape (N, 3)
and atomic_numbers has shape (N,)</p></li>
<li><p>Execute value validation checks: ensure all position values are finite
and atomic numbers are non-negative</p></li>
<li><p>Execute optional matrix validation checks: for lattice and stress tensors,
verify shape is (3, 3) and all values are finite</p></li>
<li><p>If all validations pass, create and return XYZData instance</p></li>
<li><p>If any validation fails, raise ValueError with descriptive error message</p></li>
</ul>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="rheedium.types.create_potential_slices">
<span class="sig-prename descclassname"><span class="pre">rheedium.types.</span></span><span class="sig-name descname"><span class="pre">create_potential_slices</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">slices</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Float</span><span class="p"><span class="pre">[</span></span><span class="pre">Array</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'n_slices</span> <span class="pre">height</span> <span class="pre">width'</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">slice_thickness</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><span class="pre">float</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Float</span><span class="p"><span class="pre">[</span></span><span class="pre">Array</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">''</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x_calibration</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><span class="pre">float</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Float</span><span class="p"><span class="pre">[</span></span><span class="pre">Array</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">''</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_calibration</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><span class="pre">float</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Float</span><span class="p"><span class="pre">[</span></span><span class="pre">Array</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">''</span></span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#rheedium.types.PotentialSlices" title="rheedium.types.crystal_types.PotentialSlices"><span class="pre">PotentialSlices</span></a></span></span><a class="reference internal" href="_modules/rheedium/types/crystal_types.html#create_potential_slices"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#rheedium.types.create_potential_slices" title="Link to this definition">¶</a></dt>
<dd><p>Factory function to create a PotentialSlices instance with data validation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>slices</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Float[Array</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;</span> <span class="pre">n_slices</span> <span class="pre">height</span> <span class="pre">width&quot;</span></code><code class="xref py py-class docutils literal notranslate"><span class="pre">]</span></code>) – 3D array containing potential data for each slice.</p></li>
<li><p><strong>slice_thickness</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a>) – Thickness of each slice in Ångstroms.</p></li>
<li><p><strong>x_calibration</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a>) – Real space calibration in x-direction in Ångstroms per pixel.</p></li>
<li><p><strong>y_calibration</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a>) – Real space calibration in y-direction in Ångstroms per pixel.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Validated PotentialSlices instance.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#rheedium.types.PotentialSlices" title="rheedium.types.PotentialSlices"><code class="xref py py-class docutils literal notranslate"><span class="pre">PotentialSlices</span></code></a></p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.13)"><strong>ValueError</strong></a> – If array shapes are invalid, calibrations are non-positive,
    or slice thickness is non-positive.</p>
</dd>
</dl>
<p class="rubric">Algorithm</p>
<ul class="simple">
<li><p>Convert inputs to JAX arrays with appropriate dtypes</p></li>
<li><p>Validate slice array is 3D</p></li>
<li><p>Ensure slice thickness is positive</p></li>
<li><p>Ensure calibrations are positive</p></li>
<li><p>Check that all slice data is finite</p></li>
<li><p>Create and return PotentialSlices instance</p></li>
</ul>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="rheedium.types.create_crystal_structure">
<span class="sig-prename descclassname"><span class="pre">rheedium.types.</span></span><span class="sig-name descname"><span class="pre">create_crystal_structure</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">frac_positions</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Float</span><span class="p"><span class="pre">[</span></span><span class="pre">Array</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'N</span> <span class="pre">4'</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cart_positions</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Num</span><span class="p"><span class="pre">[</span></span><span class="pre">Array</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'N</span> <span class="pre">4'</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cell_lengths</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Num</span><span class="p"><span class="pre">[</span></span><span class="pre">Array</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'3'</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cell_angles</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Num</span><span class="p"><span class="pre">[</span></span><span class="pre">Array</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'3'</span></span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#rheedium.types.CrystalStructure" title="rheedium.types.crystal_types.CrystalStructure"><span class="pre">CrystalStructure</span></a></span></span><a class="reference internal" href="_modules/rheedium/types/crystal_types.html#create_crystal_structure"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#rheedium.types.create_crystal_structure" title="Link to this definition">¶</a></dt>
<dd><p>Factory function to create a CrystalStructure instance with type checking.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>frac_positions</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Float[Array</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;</span> <span class="pre">N</span> <span class="pre">4&quot;</span></code><code class="xref py py-class docutils literal notranslate"><span class="pre">]</span></code>) – Array of shape (n_atoms, 4) containing atomic positions in fractional coordinates.</p></li>
<li><p><strong>cart_positions</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Num[Array</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;</span> <span class="pre">N</span> <span class="pre">4&quot;</span></code><code class="xref py py-class docutils literal notranslate"><span class="pre">]</span></code>) – Array of shape (n_atoms, 4) containing atomic positions in Cartesian coordinates.</p></li>
<li><p><strong>cell_lengths</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Num[Array</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;</span> <span class="pre">3&quot;</span></code><code class="xref py py-class docutils literal notranslate"><span class="pre">]</span></code>) – Unit cell lengths [a, b, c] in Ångstroms.</p></li>
<li><p><strong>cell_angles</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Num[Array</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;</span> <span class="pre">3&quot;</span></code><code class="xref py py-class docutils literal notranslate"><span class="pre">]</span></code>) – Unit cell angles [α, β, γ] in degrees.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A validated CrystalStructure instance.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#rheedium.types.CrystalStructure" title="rheedium.types.CrystalStructure"><code class="xref py py-class docutils literal notranslate"><span class="pre">CrystalStructure</span></code></a></p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.13)"><strong>ValueError</strong></a> – If the input arrays have incompatible shapes or invalid values.</p>
</dd>
</dl>
<p class="rubric">Algorithm</p>
<ul class="simple">
<li><p>Convert all inputs to JAX arrays using jnp.asarray</p></li>
<li><p>Validate shapes of frac_positions, cart_positions, cell_lengths, and cell_angles</p></li>
<li><p>Verify number of atoms matches between frac and cart positions</p></li>
<li><p>Verify atomic numbers match between frac and cart positions</p></li>
<li><p>Ensure cell lengths are positive</p></li>
<li><p>Ensure cell angles are between 0 and 180 degrees</p></li>
<li><p>Create and return CrystalStructure instance with validated data</p></li>
</ul>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="rheedium.types.create_rheed_pattern">
<span class="sig-prename descclassname"><span class="pre">rheedium.types.</span></span><span class="sig-name descname"><span class="pre">create_rheed_pattern</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">G_indices</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Int</span><span class="p"><span class="pre">[</span></span><span class="pre">Array</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'N'</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">k_out</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Float</span><span class="p"><span class="pre">[</span></span><span class="pre">Array</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'M</span> <span class="pre">3'</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">detector_points</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Float</span><span class="p"><span class="pre">[</span></span><span class="pre">Array</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'M</span> <span class="pre">2'</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">intensities</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Float</span><span class="p"><span class="pre">[</span></span><span class="pre">Array</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'M'</span></span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#rheedium.types.RHEEDPattern" title="rheedium.types.rheed_types.RHEEDPattern"><span class="pre">RHEEDPattern</span></a></span></span><a class="reference internal" href="_modules/rheedium/types/rheed_types.html#create_rheed_pattern"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#rheedium.types.create_rheed_pattern" title="Link to this definition">¶</a></dt>
<dd><p>Factory function to create a RHEEDPattern instance with data validation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>G_indices</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Int[Array</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;</span> <span class="pre">N&quot;</span></code><code class="xref py py-class docutils literal notranslate"><span class="pre">]</span></code>) – Indices of reciprocal-lattice vectors that satisfy reflection.</p></li>
<li><p><strong>k_out</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Float[Array</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;</span> <span class="pre">M</span> <span class="pre">3&quot;</span></code><code class="xref py py-class docutils literal notranslate"><span class="pre">]</span></code>) – Outgoing wavevectors (in 1/Å) for those reflections.</p></li>
<li><p><strong>detector_points</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Float[Array</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;</span> <span class="pre">M</span> <span class="pre">2&quot;</span></code><code class="xref py py-class docutils literal notranslate"><span class="pre">]</span></code>) – (Y, Z) coordinates on the detector plane, in Ångstroms.</p></li>
<li><p><strong>intensities</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Float[Array</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;</span> <span class="pre">M&quot;</span></code><code class="xref py py-class docutils literal notranslate"><span class="pre">]</span></code>) – Intensities for each reflection.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Validated RHEED pattern instance.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#rheedium.types.RHEEDPattern" title="rheedium.types.RHEEDPattern"><code class="xref py py-class docutils literal notranslate"><span class="pre">RHEEDPattern</span></code></a></p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.13)"><strong>ValueError</strong></a> – If array shapes are inconsistent or data is invalid.</p>
</dd>
</dl>
<p class="rubric">Algorithm</p>
<ul class="simple">
<li><p>Convert inputs to JAX arrays</p></li>
<li><p>Validate array shapes: check k_out has shape (M, 3), detector_points
has shape (M, 2), intensities has shape (M,), and G_indices has length M</p></li>
<li><p>Validate data: ensure intensities are non-negative, k_out vectors are
non-zero, and detector points are finite</p></li>
<li><p>Create and return RHEEDPattern instance</p></li>
</ul>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="rheedium.types.create_rheed_image">
<span class="sig-prename descclassname"><span class="pre">rheedium.types.</span></span><span class="sig-name descname"><span class="pre">create_rheed_image</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">img_array</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Float</span><span class="p"><span class="pre">[</span></span><span class="pre">Array</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'H</span> <span class="pre">W'</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">incoming_angle</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><span class="pre">float</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Float</span><span class="p"><span class="pre">[</span></span><span class="pre">Array</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">''</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">calibration</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Float</span><span class="p"><span class="pre">[</span></span><span class="pre">Array</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'2'</span></span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><span class="pre">float</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Float</span><span class="p"><span class="pre">[</span></span><span class="pre">Array</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">''</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">electron_wavelength</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><span class="pre">float</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Float</span><span class="p"><span class="pre">[</span></span><span class="pre">Array</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">''</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">detector_distance</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><span class="pre">float</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Num</span><span class="p"><span class="pre">[</span></span><span class="pre">Array</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">''</span></span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#rheedium.types.RHEEDImage" title="rheedium.types.rheed_types.RHEEDImage"><span class="pre">RHEEDImage</span></a></span></span><a class="reference internal" href="_modules/rheedium/types/rheed_types.html#create_rheed_image"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#rheedium.types.create_rheed_image" title="Link to this definition">¶</a></dt>
<dd><p>Factory function to create a RHEEDImage instance with data validation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>img_array</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Float[Array</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;</span> <span class="pre">H</span> <span class="pre">W&quot;</span></code><code class="xref py py-class docutils literal notranslate"><span class="pre">]</span></code>) – The image in 2D array format.</p></li>
<li><p><strong>incoming_angle</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a>) – The angle of the incoming electron beam in degrees.</p></li>
<li><p><strong>calibration</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Union[Float[Array</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;</span> <span class="pre">2&quot;</span></code><code class="xref py py-class docutils literal notranslate"><span class="pre">]</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">scalar_float]</span></code>) – Calibration factor for the image, either as a 2D array or a scalar.</p></li>
<li><p><strong>electron_wavelength</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a>) – The wavelength of the electrons in Ångstroms.</p></li>
<li><p><strong>detector_distance</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">numeric</span></code>) – The distance from the sample to the detector in Ångstroms.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Validated RHEED image instance.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#rheedium.types.RHEEDImage" title="rheedium.types.RHEEDImage"><code class="xref py py-class docutils literal notranslate"><span class="pre">RHEEDImage</span></code></a></p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.13)"><strong>ValueError</strong></a> – If data is invalid or parameters are out of valid ranges.</p>
</dd>
</dl>
<p class="rubric">Algorithm</p>
<ul class="simple">
<li><p>Convert inputs to JAX arrays</p></li>
<li><p>Validate image array: check it’s 2D, all values are finite and non-negative</p></li>
<li><p>Validate parameters: check incoming_angle is between 0 and 90 degrees,
electron_wavelength is positive, and detector_distance is positive</p></li>
<li><p>Validate calibration: if scalar, ensure it’s positive; if array, ensure
shape is (2,) and all values are positive</p></li>
<li><p>Create and return RHEEDImage instance</p></li>
</ul>
</dd></dl>

<p><strong>Type Aliases:</strong></p>
<dl class="py data">
<dt class="sig sig-object py" id="rheedium.types.scalar_float">
<span class="sig-prename descclassname"><span class="pre">rheedium.types.</span></span><span class="sig-name descname"><span class="pre">scalar_float</span></span><a class="headerlink" href="#rheedium.types.scalar_float" title="Link to this definition">¶</a></dt>
<dd><p>alias of <a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a> | <code class="xref py py-class docutils literal notranslate"><span class="pre">Float[Array,</span> <span class="pre">'']</span></code></p>
</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="rheedium.types.scalar_int">
<span class="sig-prename descclassname"><span class="pre">rheedium.types.</span></span><span class="sig-name descname"><span class="pre">scalar_int</span></span><a class="headerlink" href="#rheedium.types.scalar_int" title="Link to this definition">¶</a></dt>
<dd><p>alias of <a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a> | <code class="xref py py-class docutils literal notranslate"><span class="pre">Integer[Array,</span> <span class="pre">'']</span></code></p>
</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="rheedium.types.scalar_num">
<span class="sig-prename descclassname"><span class="pre">rheedium.types.</span></span><span class="sig-name descname"><span class="pre">scalar_num</span></span><a class="headerlink" href="#rheedium.types.scalar_num" title="Link to this definition">¶</a></dt>
<dd><p>alias of <a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a> | <a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a> | <code class="xref py py-class docutils literal notranslate"><span class="pre">Num[Array,</span> <span class="pre">'']</span></code></p>
</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="rheedium.types.non_jax_number">
<span class="sig-prename descclassname"><span class="pre">rheedium.types.</span></span><span class="sig-name descname"><span class="pre">non_jax_number</span></span><a class="headerlink" href="#rheedium.types.non_jax_number" title="Link to this definition">¶</a></dt>
<dd><p>alias of <a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a> | <a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a></p>
</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="rheedium.types.float_image">
<span class="sig-prename descclassname"><span class="pre">rheedium.types.</span></span><span class="sig-name descname"><span class="pre">float_image</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">&lt;class</span> <span class="pre">'jaxtyping.Float[Array,</span> <span class="pre">'H</span> <span class="pre">W']'&gt;</span></em><a class="headerlink" href="#rheedium.types.float_image" title="Link to this definition">¶</a></dt>
<dd><p>Array base class for JAX</p>
<p><code class="docutils literal notranslate"><span class="pre">jax.Array</span></code> is the public interface for instance checks and type annotation
of JAX arrays and tracers. Its main applications are in instance checks and
type annotations; for example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">jax</span><span class="o">.</span><span class="n">Array</span><span class="p">)</span>  <span class="c1"># returns True both inside and outside traced functions.</span>

<span class="k">def</span><span class="w"> </span><span class="nf">f</span><span class="p">(</span><span class="n">x</span><span class="p">:</span> <span class="n">Array</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Array</span><span class="p">:</span>  <span class="c1"># type annotations are valid for traced and non-traced types.</span>
  <span class="k">return</span> <span class="n">x</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">jax.Array</span></code> should not be used directly for creation of arrays; instead you
should use array creation routines offered in <a class="reference external" href="https://docs.jax.dev/en/latest/jax.numpy.html#module-jax.numpy" title="(in JAX)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">jax.numpy</span></code></a>, such as
<a class="reference external" href="https://docs.jax.dev/en/latest/_autosummary/jax.numpy.array.html#jax.numpy.array" title="(in JAX)"><code class="xref py py-func docutils literal notranslate"><span class="pre">jax.numpy.array()</span></code></a>, <a class="reference external" href="https://docs.jax.dev/en/latest/_autosummary/jax.numpy.zeros.html#jax.numpy.zeros" title="(in JAX)"><code class="xref py py-func docutils literal notranslate"><span class="pre">jax.numpy.zeros()</span></code></a>, <a class="reference external" href="https://docs.jax.dev/en/latest/_autosummary/jax.numpy.ones.html#jax.numpy.ones" title="(in JAX)"><code class="xref py py-func docutils literal notranslate"><span class="pre">jax.numpy.ones()</span></code></a>,
<a class="reference external" href="https://docs.jax.dev/en/latest/_autosummary/jax.numpy.full.html#jax.numpy.full" title="(in JAX)"><code class="xref py py-func docutils literal notranslate"><span class="pre">jax.numpy.full()</span></code></a>, <a class="reference external" href="https://docs.jax.dev/en/latest/_autosummary/jax.numpy.arange.html#jax.numpy.arange" title="(in JAX)"><code class="xref py py-func docutils literal notranslate"><span class="pre">jax.numpy.arange()</span></code></a>, etc.</p>
</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="rheedium.types.int_image">
<span class="sig-prename descclassname"><span class="pre">rheedium.types.</span></span><span class="sig-name descname"><span class="pre">int_image</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">&lt;class</span> <span class="pre">'jaxtyping.Integer[Array,</span> <span class="pre">'H</span> <span class="pre">W']'&gt;</span></em><a class="headerlink" href="#rheedium.types.int_image" title="Link to this definition">¶</a></dt>
<dd><p>Array base class for JAX</p>
<p><code class="docutils literal notranslate"><span class="pre">jax.Array</span></code> is the public interface for instance checks and type annotation
of JAX arrays and tracers. Its main applications are in instance checks and
type annotations; for example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">jax</span><span class="o">.</span><span class="n">Array</span><span class="p">)</span>  <span class="c1"># returns True both inside and outside traced functions.</span>

<span class="k">def</span><span class="w"> </span><span class="nf">f</span><span class="p">(</span><span class="n">x</span><span class="p">:</span> <span class="n">Array</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Array</span><span class="p">:</span>  <span class="c1"># type annotations are valid for traced and non-traced types.</span>
  <span class="k">return</span> <span class="n">x</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">jax.Array</span></code> should not be used directly for creation of arrays; instead you
should use array creation routines offered in <a class="reference external" href="https://docs.jax.dev/en/latest/jax.numpy.html#module-jax.numpy" title="(in JAX)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">jax.numpy</span></code></a>, such as
<a class="reference external" href="https://docs.jax.dev/en/latest/_autosummary/jax.numpy.array.html#jax.numpy.array" title="(in JAX)"><code class="xref py py-func docutils literal notranslate"><span class="pre">jax.numpy.array()</span></code></a>, <a class="reference external" href="https://docs.jax.dev/en/latest/_autosummary/jax.numpy.zeros.html#jax.numpy.zeros" title="(in JAX)"><code class="xref py py-func docutils literal notranslate"><span class="pre">jax.numpy.zeros()</span></code></a>, <a class="reference external" href="https://docs.jax.dev/en/latest/_autosummary/jax.numpy.ones.html#jax.numpy.ones" title="(in JAX)"><code class="xref py py-func docutils literal notranslate"><span class="pre">jax.numpy.ones()</span></code></a>,
<a class="reference external" href="https://docs.jax.dev/en/latest/_autosummary/jax.numpy.full.html#jax.numpy.full" title="(in JAX)"><code class="xref py py-func docutils literal notranslate"><span class="pre">jax.numpy.full()</span></code></a>, <a class="reference external" href="https://docs.jax.dev/en/latest/_autosummary/jax.numpy.arange.html#jax.numpy.arange" title="(in JAX)"><code class="xref py py-func docutils literal notranslate"><span class="pre">jax.numpy.arange()</span></code></a>, etc.</p>
</dd></dl>

</section>
<section id="plotting-module">
<h2>Plotting Module<a class="headerlink" href="#plotting-module" title="Link to this heading">¶</a></h2>
<section id="module-plots">
<h3>Module: plots<a class="headerlink" href="#module-plots" title="Link to this heading">¶</a></h3>
<p>Plotting and visualization utilities for RHEED data.</p>
</section>
<section id="id4">
<h3>Functions<a class="headerlink" href="#id4" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><dl class="simple">
<dt><cite>create_phosphor_colormap</cite>:</dt><dd><p>Create a custom colormap that simulates a phosphor screen appearance</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><cite>plot_rheed</cite>:</dt><dd><p>Interpolate RHEED spots onto a uniform grid and display using phosphor colormap</p>
</dd>
</dl>
</li>
</ul>
</section>
<p><strong>Functions:</strong></p>
<dl class="py function">
<dt class="sig sig-object py" id="rheedium.plots.create_phosphor_colormap">
<span class="sig-prename descclassname"><span class="pre">rheedium.plots.</span></span><span class="sig-name descname"><span class="pre">create_phosphor_colormap</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.13)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'phosphor'</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">matplotlib.colors.LinearSegmentedColormap</span></span></span><a class="reference internal" href="_modules/rheedium/plots/figuring.html#create_phosphor_colormap"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#rheedium.plots.create_phosphor_colormap" title="Link to this definition">¶</a></dt>
<dd><p>Create a custom colormap that simulates a phosphor screen appearance.</p>
<p>The colormap transitions from black through a bright phosphorescent green,
with a slight white bloom at maximum intensity.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>name</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>, <em>optional</em>) – Name for the colormap. Default is ‘phosphor’.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Custom phosphor screen colormap.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">matplotlib.colors.LinearSegmentedColormap</span></code></p>
</dd>
</dl>
<p class="rubric">Algorithm</p>
<ul class="simple">
<li><p>Define color transition points and RGB values from black through dark green,
bright green, lighter green, to white bloom</p></li>
<li><p>Extract positions and RGB values from color definitions</p></li>
<li><p>Create color channel definitions for red, green, and blue</p></li>
<li><p>Create and return LinearSegmentedColormap with custom colors</p></li>
</ul>
<div class="admonition-examples admonition">
<p class="admonition-title">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">rheedium.plots.figuring</span><span class="w"> </span><span class="kn">import</span> <span class="n">create_phosphor_colormap</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Create and display the colormap</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cmap</span> <span class="o">=</span> <span class="n">create_phosphor_colormap</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">plt</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">ScalarMappable</span><span class="p">(</span><span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Phosphor Screen Colormap&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="rheedium.plots.plot_rheed">
<span class="sig-prename descclassname"><span class="pre">rheedium.plots.</span></span><span class="sig-name descname"><span class="pre">plot_rheed</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rheed_pattern</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#rheedium.types.RHEEDPattern" title="rheedium.types.rheed_types.RHEEDPattern"><span class="pre">RHEEDPattern</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">grid_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.13)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">200</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">interp_type</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.13)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'cubic'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cmap_name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.13)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'phosphor'</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.13)"><span class="pre">None</span></a></span></span><a class="reference internal" href="_modules/rheedium/plots/figuring.html#plot_rheed"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#rheedium.plots.plot_rheed" title="Link to this definition">¶</a></dt>
<dd><p>Interpolate the RHEED spots onto a uniform grid using various methods.</p>
<p>Then display using the phosphor colormap.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>rheed_pattern</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">RHEEDPattern</span></code>) – Must have <cite>detector_points</cite> of shape (M, 2) and <cite>intensities</cite> of shape (M,).</p></li>
<li><p><strong>grid_size</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>, <em>optional</em>) – Controls how many grid points in Y and Z directions. Default is 200.</p></li>
<li><p><strong>interp_type</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>, <em>optional</em>) – Which interpolation approach to use. Default is “cubic”. Options are:
- “cubic” =&gt; calls griddata(…, method=”cubic”)
- “linear” =&gt; calls griddata(…, method=”linear”)
- “nearest” =&gt; calls griddata(…, method=”nearest”)</p></li>
<li><p><strong>cmap_name</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>, <em>optional</em>) – Name for your custom phosphor colormap. Default is ‘phosphor’.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Algorithm</p>
<ul class="simple">
<li><p>Extract coordinates and intensities from RHEED pattern</p></li>
<li><p>Convert JAX arrays to NumPy arrays</p></li>
<li><p>Validate interpolation method</p></li>
<li><p>Calculate coordinate ranges for grid and create uniform grid points</p></li>
<li><p>Interpolate intensities onto grid using griddata</p></li>
<li><p>Reshape result to 2D grid</p></li>
<li><p>Create phosphor colormap</p></li>
<li><p>Create figure and plot with colorbar, labels, and title</p></li>
<li><p>Show plot</p></li>
</ul>
<div class="admonition-examples admonition">
<p class="admonition-title">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">rheedium.plots.figuring</span><span class="w"> </span><span class="kn">import</span> <span class="n">plot_rheed</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">rheedium.types.rheed_types</span><span class="w"> </span><span class="kn">import</span> <span class="n">RHEEDPattern</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">jax.numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">jnp</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Create a simple RHEED pattern</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">points</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">intensities</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pattern</span> <span class="o">=</span> <span class="n">RHEEDPattern</span><span class="p">(</span><span class="n">points</span><span class="o">=</span><span class="n">points</span><span class="p">,</span> <span class="n">intensities</span><span class="o">=</span><span class="n">intensities</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Plot the pattern</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plot_rheed</span><span class="p">(</span><span class="n">pattern</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</dd></dl>

</section>
<section id="reconstruction-module">
<h2>Reconstruction Module<a class="headerlink" href="#reconstruction-module" title="Link to this heading">¶</a></h2>
<section id="module-recon">
<h3>Module: recon<a class="headerlink" href="#module-recon" title="Link to this heading">¶</a></h3>
<p>Reconstruction utilities for RHEED analysis.</p>
<p>This module is currently empty but reserved for future reconstruction algorithms
and analysis tools for RHEED patterns.</p>
</section>
<p><em>This module is currently empty and will be populated with reconstruction algorithms in future releases.</em></p>
</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          
          <a class="prev-page" href="tutorials/index.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">Tutorials</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2025, Debangshu Mukherjee
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">API Reference</a><ul>
<li><a class="reference internal" href="#input-output-module">Input/Output Module</a><ul>
<li><a class="reference internal" href="#module-inout">Module: inout</a></li>
<li><a class="reference internal" href="#functions">Functions</a></li>
<li><a class="reference internal" href="#rheedium.inout.parse_cif"><code class="docutils literal notranslate"><span class="pre">parse_cif()</span></code></a></li>
<li><a class="reference internal" href="#rheedium.inout.symmetry_expansion"><code class="docutils literal notranslate"><span class="pre">symmetry_expansion()</span></code></a></li>
<li><a class="reference internal" href="#rheedium.inout.atomic_symbol"><code class="docutils literal notranslate"><span class="pre">atomic_symbol()</span></code></a></li>
<li><a class="reference internal" href="#rheedium.inout.kirkland_potentials"><code class="docutils literal notranslate"><span class="pre">kirkland_potentials()</span></code></a></li>
<li><a class="reference internal" href="#rheedium.inout.parse_xyz"><code class="docutils literal notranslate"><span class="pre">parse_xyz()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#simulation-module">Simulation Module</a><ul>
<li><a class="reference internal" href="#module-simul">Module: simul</a></li>
<li><a class="reference internal" href="#id1">Functions</a></li>
<li><a class="reference internal" href="#rheedium.simul.wavelength_ang"><code class="docutils literal notranslate"><span class="pre">wavelength_ang()</span></code></a></li>
<li><a class="reference internal" href="#rheedium.simul.incident_wavevector"><code class="docutils literal notranslate"><span class="pre">incident_wavevector()</span></code></a></li>
<li><a class="reference internal" href="#rheedium.simul.project_on_detector"><code class="docutils literal notranslate"><span class="pre">project_on_detector()</span></code></a></li>
<li><a class="reference internal" href="#rheedium.simul.find_kinematic_reflections"><code class="docutils literal notranslate"><span class="pre">find_kinematic_reflections()</span></code></a></li>
<li><a class="reference internal" href="#rheedium.simul.compute_kinematic_intensities"><code class="docutils literal notranslate"><span class="pre">compute_kinematic_intensities()</span></code></a></li>
<li><a class="reference internal" href="#rheedium.simul.simulate_rheed_pattern"><code class="docutils literal notranslate"><span class="pre">simulate_rheed_pattern()</span></code></a></li>
<li><a class="reference internal" href="#rheedium.simul.atomic_potential"><code class="docutils literal notranslate"><span class="pre">atomic_potential()</span></code></a></li>
<li><a class="reference internal" href="#rheedium.simul.crystal_potential"><code class="docutils literal notranslate"><span class="pre">crystal_potential()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#unit-cell-module">Unit Cell Module</a><ul>
<li><a class="reference internal" href="#module-ucell">Module: ucell</a></li>
<li><a class="reference internal" href="#id2">Functions</a></li>
<li><a class="reference internal" href="#rheedium.ucell.angle_in_degrees"><code class="docutils literal notranslate"><span class="pre">angle_in_degrees()</span></code></a></li>
<li><a class="reference internal" href="#rheedium.ucell.compute_lengths_angles"><code class="docutils literal notranslate"><span class="pre">compute_lengths_angles()</span></code></a></li>
<li><a class="reference internal" href="#rheedium.ucell.parse_cif_and_scrape"><code class="docutils literal notranslate"><span class="pre">parse_cif_and_scrape()</span></code></a></li>
<li><a class="reference internal" href="#rheedium.ucell.reciprocal_unitcell"><code class="docutils literal notranslate"><span class="pre">reciprocal_unitcell()</span></code></a></li>
<li><a class="reference internal" href="#rheedium.ucell.reciprocal_uc_angles"><code class="docutils literal notranslate"><span class="pre">reciprocal_uc_angles()</span></code></a></li>
<li><a class="reference internal" href="#rheedium.ucell.get_unit_cell_matrix"><code class="docutils literal notranslate"><span class="pre">get_unit_cell_matrix()</span></code></a></li>
<li><a class="reference internal" href="#rheedium.ucell.build_cell_vectors"><code class="docutils literal notranslate"><span class="pre">build_cell_vectors()</span></code></a></li>
<li><a class="reference internal" href="#rheedium.ucell.generate_reciprocal_points"><code class="docutils literal notranslate"><span class="pre">generate_reciprocal_points()</span></code></a></li>
<li><a class="reference internal" href="#rheedium.ucell.atom_scraper"><code class="docutils literal notranslate"><span class="pre">atom_scraper()</span></code></a></li>
<li><a class="reference internal" href="#rheedium.ucell.bessel_kv"><code class="docutils literal notranslate"><span class="pre">bessel_kv()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#types-module">Types Module</a><ul>
<li><a class="reference internal" href="#module-types">Module: types</a></li>
<li><a class="reference internal" href="#classes">Classes</a></li>
<li><a class="reference internal" href="#id3">Functions</a></li>
<li><a class="reference internal" href="#type-aliases">Type Aliases</a></li>
<li><a class="reference internal" href="#rheedium.types.CrystalStructure"><code class="docutils literal notranslate"><span class="pre">CrystalStructure</span></code></a><ul>
<li><a class="reference internal" href="#rheedium.types.CrystalStructure.frac_positions"><code class="docutils literal notranslate"><span class="pre">CrystalStructure.frac_positions</span></code></a></li>
<li><a class="reference internal" href="#rheedium.types.CrystalStructure.cart_positions"><code class="docutils literal notranslate"><span class="pre">CrystalStructure.cart_positions</span></code></a></li>
<li><a class="reference internal" href="#rheedium.types.CrystalStructure.cell_lengths"><code class="docutils literal notranslate"><span class="pre">CrystalStructure.cell_lengths</span></code></a></li>
<li><a class="reference internal" href="#rheedium.types.CrystalStructure.cell_angles"><code class="docutils literal notranslate"><span class="pre">CrystalStructure.cell_angles</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#rheedium.types.PotentialSlices"><code class="docutils literal notranslate"><span class="pre">PotentialSlices</span></code></a><ul>
<li><a class="reference internal" href="#rheedium.types.PotentialSlices.slices"><code class="docutils literal notranslate"><span class="pre">PotentialSlices.slices</span></code></a></li>
<li><a class="reference internal" href="#rheedium.types.PotentialSlices.slice_thickness"><code class="docutils literal notranslate"><span class="pre">PotentialSlices.slice_thickness</span></code></a></li>
<li><a class="reference internal" href="#rheedium.types.PotentialSlices.x_calibration"><code class="docutils literal notranslate"><span class="pre">PotentialSlices.x_calibration</span></code></a></li>
<li><a class="reference internal" href="#rheedium.types.PotentialSlices.y_calibration"><code class="docutils literal notranslate"><span class="pre">PotentialSlices.y_calibration</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#rheedium.types.XYZData"><code class="docutils literal notranslate"><span class="pre">XYZData</span></code></a><ul>
<li><a class="reference internal" href="#rheedium.types.XYZData.positions"><code class="docutils literal notranslate"><span class="pre">XYZData.positions</span></code></a></li>
<li><a class="reference internal" href="#rheedium.types.XYZData.atomic_numbers"><code class="docutils literal notranslate"><span class="pre">XYZData.atomic_numbers</span></code></a></li>
<li><a class="reference internal" href="#rheedium.types.XYZData.lattice"><code class="docutils literal notranslate"><span class="pre">XYZData.lattice</span></code></a></li>
<li><a class="reference internal" href="#rheedium.types.XYZData.stress"><code class="docutils literal notranslate"><span class="pre">XYZData.stress</span></code></a></li>
<li><a class="reference internal" href="#rheedium.types.XYZData.energy"><code class="docutils literal notranslate"><span class="pre">XYZData.energy</span></code></a></li>
<li><a class="reference internal" href="#rheedium.types.XYZData.properties"><code class="docutils literal notranslate"><span class="pre">XYZData.properties</span></code></a></li>
<li><a class="reference internal" href="#rheedium.types.XYZData.comment"><code class="docutils literal notranslate"><span class="pre">XYZData.comment</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#rheedium.types.RHEEDPattern"><code class="docutils literal notranslate"><span class="pre">RHEEDPattern</span></code></a><ul>
<li><a class="reference internal" href="#rheedium.types.RHEEDPattern.G_indices"><code class="docutils literal notranslate"><span class="pre">RHEEDPattern.G_indices</span></code></a></li>
<li><a class="reference internal" href="#rheedium.types.RHEEDPattern.k_out"><code class="docutils literal notranslate"><span class="pre">RHEEDPattern.k_out</span></code></a></li>
<li><a class="reference internal" href="#rheedium.types.RHEEDPattern.detector_points"><code class="docutils literal notranslate"><span class="pre">RHEEDPattern.detector_points</span></code></a></li>
<li><a class="reference internal" href="#rheedium.types.RHEEDPattern.intensities"><code class="docutils literal notranslate"><span class="pre">RHEEDPattern.intensities</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#rheedium.types.RHEEDImage"><code class="docutils literal notranslate"><span class="pre">RHEEDImage</span></code></a><ul>
<li><a class="reference internal" href="#rheedium.types.RHEEDImage.img_array"><code class="docutils literal notranslate"><span class="pre">RHEEDImage.img_array</span></code></a></li>
<li><a class="reference internal" href="#rheedium.types.RHEEDImage.incoming_angle"><code class="docutils literal notranslate"><span class="pre">RHEEDImage.incoming_angle</span></code></a></li>
<li><a class="reference internal" href="#rheedium.types.RHEEDImage.calibration"><code class="docutils literal notranslate"><span class="pre">RHEEDImage.calibration</span></code></a></li>
<li><a class="reference internal" href="#rheedium.types.RHEEDImage.electron_wavelength"><code class="docutils literal notranslate"><span class="pre">RHEEDImage.electron_wavelength</span></code></a></li>
<li><a class="reference internal" href="#rheedium.types.RHEEDImage.detector_distance"><code class="docutils literal notranslate"><span class="pre">RHEEDImage.detector_distance</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#rheedium.types.make_xyz_data"><code class="docutils literal notranslate"><span class="pre">make_xyz_data()</span></code></a></li>
<li><a class="reference internal" href="#rheedium.types.create_potential_slices"><code class="docutils literal notranslate"><span class="pre">create_potential_slices()</span></code></a></li>
<li><a class="reference internal" href="#rheedium.types.create_crystal_structure"><code class="docutils literal notranslate"><span class="pre">create_crystal_structure()</span></code></a></li>
<li><a class="reference internal" href="#rheedium.types.create_rheed_pattern"><code class="docutils literal notranslate"><span class="pre">create_rheed_pattern()</span></code></a></li>
<li><a class="reference internal" href="#rheedium.types.create_rheed_image"><code class="docutils literal notranslate"><span class="pre">create_rheed_image()</span></code></a></li>
<li><a class="reference internal" href="#rheedium.types.scalar_float"><code class="docutils literal notranslate"><span class="pre">scalar_float</span></code></a></li>
<li><a class="reference internal" href="#rheedium.types.scalar_int"><code class="docutils literal notranslate"><span class="pre">scalar_int</span></code></a></li>
<li><a class="reference internal" href="#rheedium.types.scalar_num"><code class="docutils literal notranslate"><span class="pre">scalar_num</span></code></a></li>
<li><a class="reference internal" href="#rheedium.types.non_jax_number"><code class="docutils literal notranslate"><span class="pre">non_jax_number</span></code></a></li>
<li><a class="reference internal" href="#rheedium.types.float_image"><code class="docutils literal notranslate"><span class="pre">float_image</span></code></a></li>
<li><a class="reference internal" href="#rheedium.types.int_image"><code class="docutils literal notranslate"><span class="pre">int_image</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#plotting-module">Plotting Module</a><ul>
<li><a class="reference internal" href="#module-plots">Module: plots</a></li>
<li><a class="reference internal" href="#id4">Functions</a></li>
<li><a class="reference internal" href="#rheedium.plots.create_phosphor_colormap"><code class="docutils literal notranslate"><span class="pre">create_phosphor_colormap()</span></code></a></li>
<li><a class="reference internal" href="#rheedium.plots.plot_rheed"><code class="docutils literal notranslate"><span class="pre">plot_rheed()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#reconstruction-module">Reconstruction Module</a><ul>
<li><a class="reference internal" href="#module-recon">Module: recon</a></li>
</ul>
</li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script src="_static/documentation_options.js?v=0cdc004a"></script>
    <script src="_static/doctools.js?v=9bcbadda"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/scripts/furo.js?v=46bd48cc"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="_static/custom.js?v=2bc55c53"></script>
    </body>
</html>